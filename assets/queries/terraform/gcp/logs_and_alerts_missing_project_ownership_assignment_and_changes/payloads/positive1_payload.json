{
	"document": [
		{
			"file": "C:\\Users\\ricardoj\\OneDrive - Checkmarx\\Desktop\\new_kics_repo\\kics\\assets\\queries\\terraform\\gcp\\logs_and_alerts_missing_project_ownership_assignment_and_changes\\test\\positive1.tf",
			"id": "32f4e087-8107-4339-9f77-d35beae4a428",
			"resource": {
				"google_logging_metric": {
					"audit_config_change": {
						"description": "Detects changes to audit configurations via SetIamPolicy",
						"filter": "(protoPayload.serviceName=\"Wrong_service_name\")\nAND (ProjectOwnership OR projectOwnerInvitee)\nOR (protoPayload.serviceData.policyDelta.bindingDeltas.action=\"REMOVE\"\nAND protoPayload.serviceData.policyDelta.bindingDeltas.role=\"roles/owner\")\nOR (protoPayload.serviceData.policyDelta.bindingDeltas.action=\"ADD\"\nAND protoPayload.serviceData.policyDelta.bindingDeltas.role=\"roles/owner\")\n",
						"name": "audit_config_change"
					}
				},
				"google_monitoring_alert_policy": {
					"audit_config_alert": {
						"combiner": "OR",
						"conditions": {
							"condition_threshold": {
								"filter": "resource.type=\"gce_instance\" AND metric.type=\"logging.googleapis.com/user/audit_config_change\""
							},
							"display_name": "Audit Config Change Condition"
						},
						"display_name": "Audit Config Change Alert",
						"notification_channels": [
							"${google_monitoring_notification_channel.email.id}"
						]
					}
				}
			}
		}
	]
}
