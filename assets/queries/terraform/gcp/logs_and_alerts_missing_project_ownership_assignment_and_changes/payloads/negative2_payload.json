{
	"document": [
		{
			"file": "C:\\Users\\ricardoj\\OneDrive - Checkmarx\\Desktop\\new_kics_repo\\kics\\assets\\queries\\terraform\\gcp\\logs_and_alerts_missing_project_ownership_assignment_and_changes\\test\\negative2.tf",
			"id": "6eb3aaca-eaf5-427c-aa41-2cc6e14325f7",
			"resource": {
				"google_logging_metric": {
					"audit_config_change": {
						"description": "Detects changes to audit configurations via SetIamPolicy",
						"filter": "(protoPayload.serviceName=\"cloudresourcemanager.googleapis.com\")\nAND (ProjectOwnership OR projectOwnerInvitee)\nOR (protoPayload.serviceData.policyDelta.bindingDeltas.action=\"REMOVE\"\nAND protoPayload.serviceData.policyDelta.bindingDeltas.role=\"roles/owner\")\nOR (protoPayload.serviceData.policyDelta.bindingDeltas.action=\"ADD\"\nAND protoPayload.serviceData.policyDelta.bindingDeltas.role=\"roles/owner\")\n",
						"name": "audit_config_change"
					}
				},
				"google_monitoring_alert_policy": {
					"audit_config_alert": {
						"combiner": "OR",
						"conditions": {
							"condition_matched_log": {
								"filter": " ( protoPayload.serviceName  = \"cloudresourcemanager.googleapis.com\" )\nAND\n ( ProjectOwnership   OR projectOwnerInvitee  )\nOR   ( protoPayload.serviceData.policyDelta.bindingDeltas.action   =  \"REMOVE\"\nAND   protoPayload.serviceData.policyDelta.bindingDeltas.role  =   \"roles/owner\" )\nOR\n (\n  protoPayload.serviceData.policyDelta.bindingDeltas.action =   \"ADD\" AND\n    protoPayload.serviceData.policyDelta.bindingDeltas.role   = \"roles/owner\"\n    )\n"
							},
							"display_name": "Audit Config Change Condition"
						},
						"display_name": "Audit Config Change Alert (Log Match)",
						"notification_channels": [
							"${google_monitoring_notification_channel.email.id}"
						]
					}
				}
			}
		}
	]
}
