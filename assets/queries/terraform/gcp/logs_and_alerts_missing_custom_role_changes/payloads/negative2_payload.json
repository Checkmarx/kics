{
	"document": [
		{
			"file": "C:\\Users\\ricardoj\\OneDrive - Checkmarx\\Desktop\\new_kics_repo\\kics\\assets\\queries\\terraform\\gcp\\logs_and_alerts_missing_custom_role_changes\\test\\negative2.tf",
			"id": "1eae817f-d681-4900-9093-ecf07e46b071",
			"resource": {
				"google_logging_metric": {
					"audit_config_change": {
						"description": "Detects changes to audit configurations via SetIamPolicy",
						"filter": "resource.type=\"iam_role\"\nAND (protoPayload.methodName = \"google.iam.admin.v1.CreateRole\" OR\nprotoPayload.methodName=\"google.iam.admin.v1.DeleteRole\" OR\nprotoPayload.methodName=\"google.iam.admin.v1.UpdateRole\" OR\nprotoPayload.methodName=\"google.iam.admin.v1.UndeleteRole\")\n",
						"name": "audit_config_change"
					}
				},
				"google_monitoring_alert_policy": {
					"audit_config_alert": {
						"combiner": "OR",
						"conditions": {
							"condition_matched_log": {
								"filter": "resource.type = \"iam_role\"\nAND ( protoPayload.methodName = \"google.iam.admin.v1.CreateRole\" OR\n\nprotoPayload.methodName  = \"google.iam.admin.v1.DeleteRole\"\nOR\nprotoPayload.methodName =  \"google.iam.admin.v1.UpdateRole\"   OR\nprotoPayload.methodName = \"google.iam.admin.v1.UndeleteRole\" )\n"
							},
							"display_name": "Audit Config Change Condition"
						},
						"display_name": "Audit Config Change Alert (Log Match)",
						"notification_channels": [
							"${google_monitoring_notification_channel.email.id}"
						]
					}
				}
			}
		}
	]
}
