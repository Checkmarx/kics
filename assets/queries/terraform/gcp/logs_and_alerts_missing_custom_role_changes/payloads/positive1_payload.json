{
	"document": [
		{
			"file": "C:\\Users\\ricardoj\\OneDrive - Checkmarx\\Desktop\\new_kics_repo\\kics\\assets\\queries\\terraform\\gcp\\logs_and_alerts_missing_custom_role_changes\\test\\positive1.tf",
			"id": "cd0eb165-fa4c-454b-9491-01da98e66684",
			"resource": {
				"google_logging_metric": {
					"audit_config_change": {
						"description": "Detects changes to audit configurations via SetIamPolicy",
						"filter": "resource.type=\"Wrong_type\"\nAND (protoPayload.methodName = \"google.iam.admin.v1.CreateRole\" OR\nprotoPayload.methodName=\"google.iam.admin.v1.DeleteRole\" OR\nprotoPayload.methodName=\"google.iam.admin.v1.UpdateRole\" OR\nprotoPayload.methodName=\"google.iam.admin.v1.UndeleteRole\")\n",
						"name": "audit_config_change"
					}
				},
				"google_monitoring_alert_policy": {
					"audit_config_alert": {
						"combiner": "OR",
						"conditions": {
							"condition_threshold": {
								"filter": "resource.type=\"gce_instance\" AND metric.type=\"logging.googleapis.com/user/audit_config_change\""
							},
							"display_name": "Audit Config Change Condition"
						},
						"display_name": "Audit Config Change Alert",
						"notification_channels": [
							"${google_monitoring_notification_channel.email.id}"
						]
					}
				}
			}
		}
	]
}
