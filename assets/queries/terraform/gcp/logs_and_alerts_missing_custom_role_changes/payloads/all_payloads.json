{
	"document": [
		{
			"file": "C:/Users/ricardoj/OneDrive - Checkmarx/Desktop/new_kics_repo/kics/assets/queries/terraform/gcp/logs_and_alerts_missing_custom_role_changes/test/negative1.tf",
			"id": "8ce57d86-25f6-4fcd-84be-9ce7b2fab73e",
			"resource": {
				"google_logging_metric": {
					"audit_config_change": {
						"description": "Detects changes to audit configurations via SetIamPolicy",
						"filter": "resource.type=\"iam_role\"\nAND (protoPayload.methodName = \"google.iam.admin.v1.CreateRole\" OR\nprotoPayload.methodName=\"google.iam.admin.v1.DeleteRole\" OR\nprotoPayload.methodName=\"google.iam.admin.v1.UpdateRole\" OR\nprotoPayload.methodName=\"google.iam.admin.v1.UndeleteRole\")\n",
						"name": "audit_config_change"
					}
				},
				"google_monitoring_alert_policy": {
					"audit_config_alert": {
						"combiner": "OR",
						"conditions": {
							"condition_threshold": {
								"filter": "resource.type=\"gce_instance\" AND metric.type=\"logging.googleapis.com/user/audit_config_change\""
							},
							"display_name": "Audit Config Change Condition"
						},
						"display_name": "Audit Config Change Alert",
						"notification_channels": [
							"${google_monitoring_notification_channel.email.id}"
						]
					}
				}
			}
		},
		{
			"file": "C:/Users/ricardoj/OneDrive - Checkmarx/Desktop/new_kics_repo/kics/assets/queries/terraform/gcp/logs_and_alerts_missing_custom_role_changes/test/negative2.tf",
			"id": "36319d26-3ae1-474f-80d7-73f07503e89f",
			"resource": {
				"google_logging_metric": {
					"audit_config_change": {
						"description": "Detects changes to audit configurations via SetIamPolicy",
						"filter": "resource.type=\"iam_role\"\nAND (protoPayload.methodName = \"google.iam.admin.v1.CreateRole\" OR\nprotoPayload.methodName=\"google.iam.admin.v1.DeleteRole\" OR\nprotoPayload.methodName=\"google.iam.admin.v1.UpdateRole\" OR\nprotoPayload.methodName=\"google.iam.admin.v1.UndeleteRole\")\n",
						"name": "audit_config_change"
					}
				},
				"google_monitoring_alert_policy": {
					"audit_config_alert": {
						"combiner": "OR",
						"conditions": {
							"condition_matched_log": {
								"filter": "resource.type = \"iam_role\"\nAND ( protoPayload.methodName = \"google.iam.admin.v1.CreateRole\" OR\n\nprotoPayload.methodName  = \"google.iam.admin.v1.DeleteRole\"\nOR\nprotoPayload.methodName =  \"google.iam.admin.v1.UpdateRole\"   OR\nprotoPayload.methodName = \"google.iam.admin.v1.UndeleteRole\" )\n"
							},
							"display_name": "Audit Config Change Condition"
						},
						"display_name": "Audit Config Change Alert (Log Match)",
						"notification_channels": [
							"${google_monitoring_notification_channel.email.id}"
						]
					}
				}
			}
		},
		{
			"file": "C:/Users/ricardoj/OneDrive - Checkmarx/Desktop/new_kics_repo/kics/assets/queries/terraform/gcp/logs_and_alerts_missing_custom_role_changes/test/negative3.tf",
			"id": "94900a02-0b64-4038-a8e3-a4d5f4558517",
			"resource": {
				"google_logging_metric": {
					"audit_config_change_1": {
						"description": "Detects changes to audit configurations via SetIamPolicy",
						"filter": "resource.type=\"iam_role\"\nAND (protoPayload.methodName = \"google.iam.admin.v1.CreateRole\" OR\nprotoPayload.methodName=\"google.iam.admin.v1.DeleteRole\" OR\nprotoPayload.methodName=\"google.iam.admin.v1.UpdateRole\" OR\nprotoPayload.methodName=\"google.iam.admin.v1.UndeleteRole\" OR\nprotoPayload.methodName=\"any_other_value\")\n",
						"name": "audit_config_change_1"
					},
					"audit_config_change_10": {
						"description": "Detects changes to audit configurations via SetIamPolicy",
						"filter": "resource.type= (\"any_other_resource_type\" OR \"iam_role\")\nAND protoPayload.methodName = (\"google.iam.admin.v1.CreateRole\" OR\n                               \"google.iam.admin.v1.UndeleteRole\" OR\n                               \"google.iam.admin.v1.UpdateRole\" OR\n                               \"google.iam.admin.v1.DeleteRole\")\n",
						"name": "audit_config_change_10"
					},
					"audit_config_change_11": {
						"description": "Detects changes to audit configurations via SetIamPolicy",
						"filter": "resource.type= (\"type_1\" OR \"type_2\" OR \"type_3\" OR  \"type_4\" OR \"iam_role\")\nAND protoPayload.methodName = (\"google.iam.admin.v1.CreateRole\" OR\n                               \"google.iam.admin.v1.UndeleteRole\" OR\n                               \"google.iam.admin.v1.UpdateRole\" OR\n                               \"google.iam.admin.v1.DeleteRole\")\n",
						"name": "audit_config_change_11"
					},
					"audit_config_change_12": {
						"description": "Detects changes to audit configurations via SetIamPolicy",
						"filter": "NOT resource.type != \"iam_role\"\n",
						"name": "audit_config_change_12"
					},
					"audit_config_change_13": {
						"description": "Detects changes to audit configurations via SetIamPolicy",
						"filter": "resource.type != \"any_other_resource_type\" AND resource.type = \"iam_role\"\n",
						"name": "audit_config_change_13"
					},
					"audit_config_change_14": {
						"description": "Detects changes to audit configurations via SetIamPolicy",
						"filter": "resource.type != \"any_other_resource_type\" AND NOT resource.type != \"iam_role\"\n",
						"name": "audit_config_change_14"
					},
					"audit_config_change_15": {
						"description": "Detects changes to audit configurations via SetIamPolicy",
						"filter": "resource.type=\"iam_role\"\nAND (protoPayload.methodName = \"google.iam.admin.v1.CreateRole\" OR\nprotoPayload.methodName = \"google.iam.admin.v1.UndeleteRole\" OR\nprotoPayload.methodName = \"google.iam.admin.v1.UpdateRole\") OR\nprotoPayload.any_other_field = \"google.iam.admin.v1.DeleteRole\"\n",
						"name": "audit_config_change_15"
					},
					"audit_config_change_2": {
						"description": "Detects changes to audit configurations via SetIamPolicy",
						"filter": "resource.type=\"iam_role\"\nAND (protoPayload.methodName = \"google.iam.admin.v1.CreateRole\" OR\nprotoPayload.methodName=\"google.iam.admin.v1.DeleteRole\" OR\nprotoPayload.methodName=\"google.iam.admin.v1.UpdateRole\" OR\nprotoPayload.methodName=\"google.iam.admin.v1.UndeleteRole\") OR\nprotoPayload.methodName=\"any_other_value\"\n",
						"name": "audit_config_change_2"
					},
					"audit_config_change_4": {
						"description": "Detects changes to audit configurations via SetIamPolicy",
						"filter": "resource.type=\"iam_role\" OR resource.type=\"any_other_resource_type\"\nAND (protoPayload.methodName = \"google.iam.admin.v1.CreateRole\" OR\nprotoPayload.methodName=\"google.iam.admin.v1.UndeleteRole\" OR\nprotoPayload.methodName=\"google.iam.admin.v1.UpdateRole\") OR\nprotoPayload.methodName=\"google.iam.admin.v1.DeleteRole\"\n",
						"name": "audit_config_change_4"
					},
					"audit_config_change_5": {
						"description": "Detects changes to audit configurations via SetIamPolicy",
						"filter": "resource.type= (\"iam_role\" OR \"any_other_resource_type\")\nAND protoPayload.methodName = (\"google.iam.admin.v1.CreateRole\" OR\n                               \"google.iam.admin.v1.UndeleteRole\" OR\n                               \"google.iam.admin.v1.UpdateRole\" OR\n                               \"google.iam.admin.v1.DeleteRole\")\n",
						"name": "audit_config_change_5"
					},
					"audit_config_change_6": {
						"description": "Detects changes to audit configurations via SetIamPolicy",
						"filter": "resource.type= \"iam_role\"\nAND protoPayload.methodName = (\"google.iam.admin.v1.CreateRole\" OR \"google.iam.admin.v1.UndeleteRole\" OR \"google.iam.admin.v1.UpdateRole\" OR \"google.iam.admin.v1.DeleteRole\")\n",
						"name": "audit_config_change_6"
					},
					"audit_config_change_7": {
						"description": "Detects changes to audit configurations via SetIamPolicy",
						"filter": "resource.type= (\"iam_role\" OR \"any_other_resource_type\")\n",
						"name": "audit_config_change_7"
					},
					"audit_config_change_8": {
						"description": "Detects changes to audit configurations via SetIamPolicy",
						"filter": "resource.type = \"iam_role\"\nAND protoPayload.methodName = *\n",
						"name": "audit_config_change_8"
					},
					"audit_config_change_9": {
						"description": "Detects changes to audit configurations via SetIamPolicy",
						"filter": "resource.type=\"any_other_resource_type\" OR resource.type=\"iam_role\"\nAND (protoPayload.methodName = \"google.iam.admin.v1.CreateRole\" OR\nprotoPayload.methodName=\"google.iam.admin.v1.UndeleteRole\" OR\nprotoPayload.methodName=\"google.iam.admin.v1.UpdateRole\") OR\nprotoPayload.methodName=\"google.iam.admin.v1.DeleteRole\"\n",
						"name": "audit_config_change_9"
					}
				}
			}
		},
		{
			"file": "C:/Users/ricardoj/OneDrive - Checkmarx/Desktop/new_kics_repo/kics/assets/queries/terraform/gcp/logs_and_alerts_missing_custom_role_changes/test/negative4.tf",
			"id": "6a7840a5-7445-4d00-af0c-4aa9a5a12df5",
			"resource": {
				"google_logging_metric": {
					"audit_config_change_1": {
						"description": "Detects changes to audit configurations via SetIamPolicy",
						"filter": "ReSOuRcE.tYpE=\"iam_role\"\nAND (ProTOPAyLoAD.METHODName = \"google.iam.admin.v1.CreateRole\" OR\nPRotoPayLOAD.methodNAME=\"google.iam.admin.v1.DeleteRole\" OR\nPROTOPAYLOAD.MEthoDNAme=\"google.iam.admin.v1.UpdateRole\" OR\nProTOPAyLoAD.METhodNAME=\"google.iam.admin.v1.UndeleteRole\" OR\nPRotoPayLOAD.MeTHoDNAME=\"any_other_value\")\n",
						"name": "audit_config_change_1"
					}
				}
			}
		},
		{
			"file": "C:/Users/ricardoj/OneDrive - Checkmarx/Desktop/new_kics_repo/kics/assets/queries/terraform/gcp/logs_and_alerts_missing_custom_role_changes/test/positive1.tf",
			"id": "7a0ed139-693f-4ced-9e71-3983c1d19283",
			"resource": {
				"google_logging_metric": {
					"audit_config_change": {
						"description": "Detects changes to audit configurations via SetIamPolicy",
						"filter": "resource.type=\"Wrong_type\"\nAND (protoPayload.methodName = \"google.iam.admin.v1.CreateRole\" OR\nprotoPayload.methodName=\"google.iam.admin.v1.DeleteRole\" OR\nprotoPayload.methodName=\"google.iam.admin.v1.UpdateRole\" OR\nprotoPayload.methodName=\"google.iam.admin.v1.UndeleteRole\")\n",
						"name": "audit_config_change"
					}
				},
				"google_monitoring_alert_policy": {
					"audit_config_alert": {
						"combiner": "OR",
						"conditions": {
							"condition_threshold": {
								"filter": "resource.type=\"gce_instance\" AND metric.type=\"logging.googleapis.com/user/audit_config_change\""
							},
							"display_name": "Audit Config Change Condition"
						},
						"display_name": "Audit Config Change Alert",
						"notification_channels": [
							"${google_monitoring_notification_channel.email.id}"
						]
					}
				}
			}
		},
		{
			"file": "C:/Users/ricardoj/OneDrive - Checkmarx/Desktop/new_kics_repo/kics/assets/queries/terraform/gcp/logs_and_alerts_missing_custom_role_changes/test/positive2.tf",
			"id": "914d8ce5-037d-4eef-bc2a-558bcf1d84b2",
			"resource": {
				"google_logging_metric": {
					"audit_config_change": {
						"description": "Detects changes to audit configurations via SetIamPolicy",
						"filter": "resource.type=\"iam_role\"\nAND (protoPayload.methodName = \"google.iam.admin.v1.CreateRole\" OR\nprotoPayload.methodName=\"google.iam.admin.v1.DeleteRole\" OR\nprotoPayload.methodName=\"google.iam.admin.v1.UpdateRole\" OR\nprotoPayload.methodName=\"google.iam.admin.v1.UndeleteRole\")\n",
						"name": "audit_config_change"
					}
				},
				"google_monitoring_alert_policy": {
					"audit_config_alert": {
						"combiner": "OR",
						"conditions": {
							"condition_threshold": {
								"filter": "resource.type=\"gce_instance\" AND metric.type=\"logging.googleapis.com/user/wrong_reference\""
							},
							"display_name": "Audit Config Change Condition"
						},
						"display_name": "Audit Config Change Alert",
						"notification_channels": [
							"${google_monitoring_notification_channel.email.id}"
						]
					}
				}
			}
		},
		{
			"file": "C:/Users/ricardoj/OneDrive - Checkmarx/Desktop/new_kics_repo/kics/assets/queries/terraform/gcp/logs_and_alerts_missing_custom_role_changes/test/positive3.tf",
			"id": "30d0c296-7ea5-4b4b-8fa0-b45fde75b497",
			"resource": {
				"google_logging_metric": {
					"audit_config_change": {
						"description": "Detects changes to audit configurations via SetIamPolicy",
						"filter": "resource.type=\"iam_role\"\nAND (protoPayload.methodName = \"google.iam.admin.v1.CreateRole\" OR\nprotoPayload.methodName=\"google.iam.admin.v1.DeleteRole\" OR\nprotoPayload.methodName=\"google.iam.admin.v1.UpdateRole\" OR\nprotoPayload.methodName=\"google.iam.admin.v1.UndeleteRole\")\n",
						"name": "audit_config_change"
					}
				},
				"google_monitoring_alert_policy": {
					"audit_config_alert": {
						"combiner": "OR",
						"conditions": {
							"condition_matched_log": {
								"filter": "resource.type=\"iam_role\"\nAND (protoPayload.methodName = \"google.iam.admin.v1.INCORRECT_METHOD\" OR\nprotoPayload.methodName=\"google.iam.admin.v1.DeleteRole\" OR\nprotoPayload.methodName=\"google.iam.admin.v1.UpdateRole\" OR\nprotoPayload.methodName=\"google.iam.admin.v1.UndeleteRole\")\n"
							},
							"display_name": "Audit Config Change Condition"
						},
						"display_name": "Audit Config Change Alert (Log Match)",
						"notification_channels": [
							"${google_monitoring_notification_channel.email.id}"
						]
					}
				}
			}
		},
		{
			"file": "C:/Users/ricardoj/OneDrive - Checkmarx/Desktop/new_kics_repo/kics/assets/queries/terraform/gcp/logs_and_alerts_missing_custom_role_changes/test/positive4.tf",
			"id": "df5e9ee1-931d-41f6-b830-f045c070ec8c",
			"resource": {
				"google_logging_metric": {
					"audit_config_change": {
						"description": "Detects changes to audit configurations via SetIamPolicy",
						"filter": "resource.type=\"iam_role\"\nAND (protoPayload.methodName = \"google.iam.admin.v1.CreateRole\" OR\nprotoPayload.methodName=\"google.iam.admin.v1.DeleteRole\" OR\nprotoPayload.methodName=\"google.iam.admin.v1.UpdateRole\" OR\nprotoPayload.methodName=\"google.iam.admin.v1.UndeleteRole\")\n",
						"name": "audit_config_change"
					}
				},
				"google_monitoring_alert_policy": {
					"audit_config_alert": {
						"combiner": "OR",
						"conditions": {
							"condition_threshold": {
								"filter": "resource.type=\"gce_instance\" AND metric.type=\"logging.googleapis.com/user/audit_config_change\""
							},
							"display_name": "Audit Config Change Condition"
						},
						"display_name": "Audit Config Change Alert"
					}
				}
			}
		},
		{
			"file": "C:/Users/ricardoj/OneDrive - Checkmarx/Desktop/new_kics_repo/kics/assets/queries/terraform/gcp/logs_and_alerts_missing_custom_role_changes/test/positive5.tf",
			"id": "30332d0b-81a3-4f8f-8fc5-4f88538ef6e2",
			"resource": {
				"google_monitoring_alert_policy": {
					"audit_config_alert": {
						"combiner": "OR",
						"conditions": {
							"condition_matched_log": {
								"filter": "resource.type = \"iam_role\"\nAND ( protoPayload.methodName = \"google.iam.admin.v1.CreateRole\" OR\n\nprotoPayload.methodName  = \"google.iam.admin.v1.DeleteRole\"\nOR\nprotoPayload.methodName =  \"google.iam.admin.v1.UpdateRole\"   OR\nprotoPayload.methodName = \"google.iam.admin.v1.UndeleteRole\" )\n"
							},
							"display_name": "Audit Config Change Condition"
						},
						"display_name": "Audit Config Change Alert (Log Match)"
					}
				}
			}
		},
		{
			"file": "C:/Users/ricardoj/OneDrive - Checkmarx/Desktop/new_kics_repo/kics/assets/queries/terraform/gcp/logs_and_alerts_missing_custom_role_changes/test/positive6.tf",
			"id": "8146392b-eb2e-4ceb-8a6e-bb04474be96a",
			"resource": {
				"google_monitoring_alert_policy": {
					"audit_config_alert": {
						"combiner": "OR",
						"conditions": {
							"condition_threshold": {
								"filter": "resource.type=\"gce_instance\" AND metric.type=\"logging.googleapis.com/user/audit_config_change\""
							},
							"display_name": "Audit Config Change Condition"
						},
						"display_name": "Audit Config Change Alert",
						"notification_channels": [
							"${google_monitoring_notification_channel.email.id}"
						]
					}
				}
			}
		},
		{
			"file": "C:/Users/ricardoj/OneDrive - Checkmarx/Desktop/new_kics_repo/kics/assets/queries/terraform/gcp/logs_and_alerts_missing_custom_role_changes/test/positive7.tf",
			"id": "02fa25c2-4d3a-4283-9ada-f8cf19c5cd25",
			"resource": {
				"google_logging_metric": {
					"audit_config_change": {
						"description": "Detects changes to audit configurations via SetIamPolicy",
						"filter": "resource.type=\"iam_role\"\nAND (protoPayload.methodName = \"google.iam.admin.v1.CreateRole\" OR\nprotoPayload.methodName=\"google.iam.admin.v1.DeleteRole\" OR\nprotoPayload.methodName=\"google.iam.admin.v1.UpdateRole\" OR\nprotoPayload.methodName=\"google.iam.admin.v1.UndeleteRole\")\nAND protoPayload.serviceData.policyDelta.bindingDeltas.role=\"roles/editor\"\n",
						"name": "audit_config_change"
					}
				}
			}
		},
		{
			"file": "C:/Users/ricardoj/OneDrive - Checkmarx/Desktop/new_kics_repo/kics/assets/queries/terraform/gcp/logs_and_alerts_missing_custom_role_changes/test/positive8.tf",
			"id": "59b29e00-8439-443e-9c2c-c6a3593c089e",
			"resource": {
				"google_logging_metric": {
					"audit_config_change": {
						"description": "Detects changes to audit configurations via SetIamPolicy",
						"filter": "resource.type=\"Wrong_type\"\nAND (protoPayload.methodName = \"google.iam.admin.v1.CreateRole\" OR\nprotoPayload.methodName=\"google.iam.admin.v1.DeleteRole\" OR\nprotoPayload.methodName=\"google.iam.admin.v1.UpdateRole\" OR\nprotoPayload.methodName=\"google.iam.admin.v1.UndeleteRole\")\n",
						"name": "audit_config_change"
					}
				}
			}
		},
		{
			"file": "C:/Users/ricardoj/OneDrive - Checkmarx/Desktop/new_kics_repo/kics/assets/queries/terraform/gcp/logs_and_alerts_missing_custom_role_changes/test/positive9.tf",
			"id": "fa4cf61b-523b-4649-b5b8-e6089678c77b",
			"resource": {
				"google_logging_metric": {
					"audit_config_change": {
						"description": "Detects changes to audit configurations via SetIamPolicy",
						"filter": "resource.type=\"iam_role\" AND resource.type=\"any_other_value\"\nAND (protoPayload.methodName = \"google.iam.admin.v1.CreateRole\" OR\nprotoPayload.methodName=\"google.iam.admin.v1.DeleteRole\" OR\nprotoPayload.methodName=\"google.iam.admin.v1.UpdateRole\" OR\nprotoPayload.methodName=\"google.iam.admin.v1.UndeleteRole\")\n",
						"name": "audit_config_change"
					}
				}
			}
		},
		{
			"file": "C:/Users/ricardoj/OneDrive - Checkmarx/Desktop/new_kics_repo/kics/assets/queries/terraform/gcp/logs_and_alerts_missing_custom_role_changes/test/test.tf",
			"id": "8a8e2dfc-454a-4e43-82d4-b0e53806ef7b",
			"resource": {
				"google_logging_metric": {
					"audit_config_change": {
						"description": "Detects changes to audit configurations via SetIamPolicy",
						"filter": "resource.type=\"iam_role\"\nAND (protoPayload.methodName = \"google.iam.admin.v1.CreateRole\" OR\nprotoPayload.methodName=\"google.iam.admin.v1.DeleteRole\" OR\nprotoPayload.methodName=\"google.iam.admin.v1.UpdateRole\")\n",
						"name": "audit_config_change"
					}
				},
				"google_monitoring_alert_policy": {
					"audit_config_alert": {
						"combiner": "OR",
						"conditions": {
							"condition_threshold": {
								"filter": "resource.type=\"gce_instance\" AND metric.type=\"logging.googleapis.com/user/audit_config_change\""
							},
							"display_name": "Audit Config Change Condition"
						},
						"display_name": "Audit Config Change Alert",
						"notification_channels": [
							"${google_monitoring_notification_channel.email.id}"
						]
					}
				}
			}
		}
	]
}
