{
	"document": [
		{
			"file": "C:/Users/ricardoj/OneDrive - Checkmarx/Desktop/new_kics_repo/kics/assets/queries/terraform/aws/alb_listening_on_http/test/negative1.tf",
			"id": "343ae40c-3bbd-45ce-ab74-84ff82d2fe86",
			"resource": {
				"aws_lb": {
					"test33": {
						"internal": true,
						"load_balancer_type": "application",
						"name": "test123",
						"subnets": [
							"${aws_subnet.subnet1.id}",
							"${aws_subnet.subnet2.id}"
						]
					}
				},
				"aws_lb_listener": {
					"listener55": {
						"default_action": {
							"redirect": {
								"port": "80",
								"protocol": "HTTPS",
								"status_code": "HTTPS_301"
							},
							"type": "redirect"
						},
						"load_balancer_arn": "${aws_lb.test33.arn}",
						"port": 80
					}
				}
			}
		},
		{
			"data": {
				"aws_ami": {
					"ubuntu2": {
						"filter": [
							{
								"name": "name",
								"values": [
									"ubuntu/images/hvm-ssd/ubuntu-xenial-16.04-amd64-server-*"
								]
							},
							{
								"name": "virtualization-type",
								"values": [
									"hvm"
								]
							}
						],
						"most_recent": true,
						"owners": [
							"099720109477"
						]
					}
				},
				"aws_availability_zones": {
					"available2": {
						"state": "available"
					}
				}
			},
			"file": "C:/Users/ricardoj/OneDrive - Checkmarx/Desktop/new_kics_repo/kics/assets/queries/terraform/aws/alb_listening_on_http/test/negative2.tf",
			"id": "0d4f77a3-11ae-4e87-8f2c-1f0b2d7857d2",
			"provider": {
				"aws2": {
					"profile": "default",
					"region": "us-west-2"
				}
			},
			"resource": {
				"aws_default_security_group": {
					"dsg2": {
						"vpc_id": "${aws_vpc.vpc1.id}"
					}
				},
				"aws_instance": {
					"inst12": {
						"ami": "${data.aws_ami.ubuntu2.id}",
						"instance_type": "t3.micro",
						"subnet_id": "${aws_subnet.subnet12.id}",
						"vpc_security_group_ids": [
							"${aws_default_security_group.dsg2.id}"
						]
					},
					"inst22": {
						"ami": "${data.aws_ami.ubuntu2.id}",
						"instance_type": "t3.micro",
						"subnet_id": "${aws_subnet.subnet12.id}",
						"vpc_security_group_ids": [
							"${aws_default_security_group.dsg2.id}"
						]
					},
					"inst32": {
						"ami": "${data.aws_ami.ubuntu2.id}",
						"instance_type": "t3.micro",
						"subnet_id": "${aws_subnet.subnet12.id}",
						"vpc_security_group_ids": [
							"${aws_default_security_group.dsg2.id}"
						]
					}
				},
				"aws_lb": {
					"test2": {
						"internal": true,
						"load_balancer_type": "application",
						"name": "test123",
						"subnets": [
							"${aws_subnet.subnet12.id}",
							"${aws_subnet.subnet22.id}"
						]
					}
				},
				"aws_lb_listener": {
					"listener2": {
						"default_action": {
							"target_group_arn": "${aws_lb_target_group.test2.arn}",
							"type": "forward"
						},
						"load_balancer_arn": "${aws_lb.test2.arn}",
						"port": 80,
						"protocol": "HTTPS"
					}
				},
				"aws_lb_target_group": {
					"test2": {
						"port": 80,
						"protocol": "HTTP",
						"target_type": "instance",
						"vpc_id": "${aws_vpc.vpc1.id}"
					}
				},
				"aws_lb_target_group_attachment": {
					"attach12": {
						"port": 80,
						"target_group_arn": "${aws_lb_target_group.test2.arn}",
						"target_id": "${aws_instance.inst12.id}"
					},
					"attach22": {
						"port": 80,
						"target_group_arn": "${aws_lb_target_group.test2.arn}",
						"target_id": "${aws_instance.inst22.id}"
					},
					"attach32": {
						"port": 80,
						"target_group_arn": "${aws_lb_target_group.test2.arn}",
						"target_id": "${aws_instance.inst32.id}"
					}
				},
				"aws_subnet": {
					"subnet12": {
						"availability_zone_id": "${data.aws_availability_zones.available2.zone_ids[0]}",
						"cidr_block": "10.10.10.0/24",
						"tags": {
							"Name": "subnet1"
						},
						"vpc_id": "${aws_vpc.vpc1.id}"
					},
					"subnet22": {
						"availability_zone_id": "${data.aws_availability_zones.available2.zone_ids[1]}",
						"cidr_block": "10.10.11.0/24",
						"tags": {
							"Name": "subnet2"
						},
						"vpc_id": "${aws_vpc.vpc1.id}"
					}
				},
				"aws_vpc": {
					"vpc1": {
						"cidr_block": "10.10.0.0/16"
					}
				}
			}
		},
		{
			"file": "C:/Users/ricardoj/OneDrive - Checkmarx/Desktop/new_kics_repo/kics/assets/queries/terraform/aws/alb_listening_on_http/test/positive1.tf",
			"id": "fd4f2cf8-41ea-4ea1-beab-fa257f47617d",
			"resource": {
				"aws_lb": {
					"test3": {
						"internal": true,
						"load_balancer_type": "application",
						"name": "test123",
						"subnets": [
							"${aws_subnet.subnet1.id}",
							"${aws_subnet.subnet2.id}"
						]
					}
				},
				"aws_lb_listener": {
					"listener5": {
						"default_action": {
							"redirect": {
								"port": "80",
								"protocol": "HTTP",
								"status_code": "HTTP_301"
							},
							"type": "redirect"
						},
						"load_balancer_arn": "${aws_lb.test3.arn}",
						"port": 80
					}
				}
			}
		},
		{
			"data": {
				"aws_ami": {
					"ubuntu": {
						"filter": [
							{
								"name": "name",
								"values": [
									"ubuntu/images/hvm-ssd/ubuntu-xenial-16.04-amd64-server-*"
								]
							},
							{
								"name": "virtualization-type",
								"values": [
									"hvm"
								]
							}
						],
						"most_recent": true,
						"owners": [
							"099720109477"
						]
					}
				},
				"aws_availability_zones": {
					"available": {
						"state": "available"
					}
				}
			},
			"file": "C:/Users/ricardoj/OneDrive - Checkmarx/Desktop/new_kics_repo/kics/assets/queries/terraform/aws/alb_listening_on_http/test/positive2.tf",
			"id": "042582bb-c75f-4c54-9c32-f3dfe10cc957",
			"provider": {
				"aws": {
					"profile": "default",
					"region": "us-west-2"
				}
			},
			"resource": {
				"aws_default_security_group": {
					"dsg": {
						"vpc_id": "${aws_vpc.vpc1.id}"
					}
				},
				"aws_instance": {
					"inst1": {
						"ami": "${data.aws_ami.ubuntu.id}",
						"instance_type": "t3.micro",
						"subnet_id": "${aws_subnet.subnet1.id}",
						"vpc_security_group_ids": [
							"${aws_default_security_group.dsg.id}"
						]
					},
					"inst2": {
						"ami": "${data.aws_ami.ubuntu.id}",
						"instance_type": "t3.micro",
						"subnet_id": "${aws_subnet.subnet1.id}",
						"vpc_security_group_ids": [
							"${aws_default_security_group.dsg.id}"
						]
					},
					"inst3": {
						"ami": "${data.aws_ami.ubuntu.id}",
						"instance_type": "t3.micro",
						"subnet_id": "${aws_subnet.subnet1.id}",
						"vpc_security_group_ids": [
							"${aws_default_security_group.dsg.id}"
						]
					}
				},
				"aws_lb": {
					"test": {
						"internal": true,
						"load_balancer_type": "application",
						"name": "test123",
						"subnets": [
							"${aws_subnet.subnet1.id}",
							"${aws_subnet.subnet2.id}"
						]
					}
				},
				"aws_lb_listener": {
					"listener": {
						"default_action": {
							"target_group_arn": "${aws_lb_target_group.test.arn}",
							"type": "forward"
						},
						"load_balancer_arn": "${aws_lb.test.arn}",
						"port": 80
					}
				},
				"aws_lb_target_group": {
					"test": {
						"port": 80,
						"protocol": "HTTP",
						"target_type": "instance",
						"vpc_id": "${aws_vpc.vpc1.id}"
					}
				},
				"aws_lb_target_group_attachment": {
					"attach1": {
						"port": 80,
						"target_group_arn": "${aws_lb_target_group.test.arn}",
						"target_id": "${aws_instance.inst1.id}"
					},
					"attach2": {
						"port": 80,
						"target_group_arn": "${aws_lb_target_group.test.arn}",
						"target_id": "${aws_instance.inst2.id}"
					},
					"attach3": {
						"port": 80,
						"target_group_arn": "${aws_lb_target_group.test.arn}",
						"target_id": "${aws_instance.inst3.id}"
					}
				},
				"aws_subnet": {
					"subnet1": {
						"availability_zone_id": "${data.aws_availability_zones.available.zone_ids[0]}",
						"cidr_block": "10.10.10.0/24",
						"tags": {
							"Name": "subnet1"
						},
						"vpc_id": "${aws_vpc.vpc1.id}"
					},
					"subnet2": {
						"availability_zone_id": "${data.aws_availability_zones.available.zone_ids[1]}",
						"cidr_block": "10.10.11.0/24",
						"tags": {
							"Name": "subnet2"
						},
						"vpc_id": "${aws_vpc.vpc1.id}"
					}
				},
				"aws_vpc": {
					"vpc1": {
						"cidr_block": "10.10.0.0/16"
					}
				}
			}
		}
	]
}
