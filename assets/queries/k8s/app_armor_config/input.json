{
	"document": [
		{
			"descriptionText": "Containers should be configured with AppArmor for any application to reduce its potential attack",
			"descriptionUrl": "https://gsl.dome9.com/D9.K8S.IAM.23.html",
			"file": "assets/queries/k8s/app_armor_config/metadata.json",
			"id": "b10ed5d9-4acf-4f69-9b73-6199c7a9a5c0",
			"queryName": "app_armor_config",
			"severity": "LOW",
			"category": null
		},
		{
			"apiVersion": "v1",
			"kind": "Pod",
			"metadata": {
				"name": "hello-apparmor-1",
				"annotations": {
					"container.apparmor/hello1": "localhost/k8s-apparmor-example-allow-write"
				}
			},
			"spec": {
				"containers": [
					{
						"command": [
							"sh",
							"-c",
							"echo 'Hello AppArmor!' \u0026\u0026 sleep 1h"
						],
						"name": "hello1",
						"image": "busybox"
					}
				]
			},
			"id": "b91b5901-7f85-4e78-8904-190485ad8de2",
			"file": "assets/queries/k8s/app_armor_config/test/negative.yaml"
		},
		{
			"spec": {
				"containers": [
					{
						"image": "busybox",
						"command": [
							"sh",
							"-c",
							"echo 'Hello AppArmor!' \u0026\u0026 sleep 1h"
						],
						"name": "hello2"
					}
				]
			},
			"id": "738950b3-1c8b-4a04-aa95-c06b1fd69a86",
			"file": "assets/queries/k8s/app_armor_config/test/negative.yaml",
			"apiVersion": "v2",
			"kind": "Pod",
			"metadata": {
				"name": "hello-apparmor-2"
			}
		},
		{
			"file": "assets/queries/k8s/app_armor_config/test/negative.yaml",
			"apiVersion": "v4",
			"kind": "Pod",
			"metadata": {
				"name": "hello-apparmor4",
				"annotations": {
					"ingress-whitelist": "qa.acmecorp.internal.acmecorp.com"
				}
			},
			"spec": {
				"containers": [
					{
						"name": "hello4",
						"image": "busybox",
						"command": [
							"sh",
							"-c",
							"echo 'Hello AppArmor!' \u0026\u0026 sleep 1h"
						]
					}
				]
			},
			"id": "e2747a20-5b07-44a8-b355-051565907481"
		},
		{
			"apiVersion": "v5",
			"kind": "Pod",
			"metadata": {
				"name": "hello-apparmor5",
				"annotations": null
			},
			"spec": {
				"containers": [
					{
						"name": "hello5",
						"image": "busybox",
						"command": [
							"sh",
							"-c",
							"echo 'Hello AppArmor!' \u0026\u0026 sleep 1h"
						]
					}
				]
			},
			"id": "7fac65da-f0dc-464f-813d-777d6f2ed188",
			"file": "assets/queries/k8s/app_armor_config/test/negative.yaml"
		},
		{
			"apiVersion": "v1",
			"kind": "Pod",
			"metadata": {
				"name": "hello-apparmor-2positive",
				"annotations": {
					"container.apparmor.security.beta.kubernetes.io/hello": "localhost/k8s-apparmor-example-allow-write"
				}
			},
			"spec": {
				"containers": [
					{
						"name": "hello",
						"image": "busybox",
						"command": [
							"sh",
							"-c",
							"echo 'Hello AppArmor!' \u0026\u0026 sleep 1h"
						]
					}
				]
			},
			"id": "521ce332-ada8-49d4-940c-80998ec88325",
			"file": "assets/queries/k8s/app_armor_config/test/positive.yaml"
		}
	]
}
