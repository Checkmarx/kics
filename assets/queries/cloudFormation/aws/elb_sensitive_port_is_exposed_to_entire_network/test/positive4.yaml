Resources:
  LoadBalancer01:
    Type: AWS::ElasticLoadBalancingV2::LoadBalancer
    Properties:
      SecurityGroups:
        - !Ref DualStackSecurityGroup

  DualStackSecurityGroup:
    Type: AWS::EC2::SecurityGroup
    Properties:
      GroupDescription: "Security group for IPv4 and IPv6 ingress rules"
      VpcId: !Ref MyVPC
      SecurityGroupIngress:
        # -----------------------
        # IPv4 Rules
        # -----------------------
        - IpProtocol: "17"       # UDP (protocol 17)
          FromPort: 137
          ToPort: 137
          CidrIp: "10.0.0.0/0"

        - IpProtocol: "tcp"
          FromPort: 22
          ToPort: 22
          CidrIp: "192.168.0.0/0"

        - IpProtocol: "udp"
          FromPort: 137
          ToPort: 137
          CidrIp: "172.16.0.0/0"

        - IpProtocol: "udp"
          FromPort: 138
          ToPort: 138
          CidrIp: "172.16.0.0/0"

        # -----------------------
        # IPv6 Rules
        # -----------------------
        - IpProtocol: "6"        # TCP (protocol 6)
          FromPort: 22
          ToPort: 22
          CidrIpv6: "fd00::/0"

        - IpProtocol: "tcp"
          FromPort: 22
          ToPort: 22
          CidrIpv6: "fd12:3456:789a::1/0"

        - IpProtocol: "udp"
          FromPort: 137
          ToPort: 137
          CidrIpv6: "fd00:abcd:1234::42/0"

        - IpProtocol: "udp"
          FromPort: 138
          ToPort: 138
          CidrIpv6: "fd00:abcd:1234::42/0"
