package generic.common

getDocument() = document { # is this really fully generic?
    document := input.document
}

json_unmarshal(s) = result {
    s == null
    result := json.unmarshal("{}")
}

json_unmarshal(s) = result {
    s != null
    result := json.unmarshal(s)
}

calc_IP_value (ip) = result {
    ips := split(ip, ".")

    #calculate the value of an ip
    #a.b.c.d
    #a*16777216 + b*65536 + c*256 + d
    result = (to_number(ips[0]) * 16777216) + (to_number(ips[1]) * 65536) + (to_number(ips[2]) * 256) + to_number(ips[3])
}
