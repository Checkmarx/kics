<!DOCTYPE html>
<html lang="en">
    <head>
        <meta charset="utf-8">
        <meta http-equiv="X-UA-Compatible" content="IE=edge">
        <meta name="viewport" content="width=device-width, initial-scale=1.0">
        
        
        <link rel="canonical" href="http://www.kics.io/1.3.1/queries/dockerfile-queries/">
        <link rel="shortcut icon" href="../../img/favicon.ico">
        <title>Dockerfile - KICS</title>
        <link href="../../css/bootstrap.min.css" rel="stylesheet">
        <link href="../../css/font-awesome.min.css" rel="stylesheet">
        <link href="../../css/base.css" rel="stylesheet">
        <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/9.12.0/styles/docco.min.css">
        <link href="../../css/custom.css" rel="stylesheet">

        <script src="../../js/jquery-1.10.2.min.js" defer></script>
        <script src="../../js/bootstrap.min.js" defer></script>
        <script src="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/9.12.0/highlight.min.js"></script>
        <script>hljs.initHighlightingOnLoad();</script>
        <script>
            (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
            (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
            m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
            })(window,document,'script','https://www.google-analytics.com/analytics.js','ga');

            ga('create', 'UA-186818347-2', 'auto');
            ga('send', 'pageview');
        </script> 
    </head>

    <body>
        <div class="navbar fixed-top navbar-expand-lg navbar-dark bg-primary">
            <div class="container">
                <a class="navbar-brand" href="../..">KICS</a>
                <!-- Expander button -->
                <button type="button" class="navbar-toggler" data-toggle="collapse" data-target="#navbar-collapse">
                    <span class="navbar-toggler-icon"></span>
                </button>

                <!-- Expanded navigation -->
                <div id="navbar-collapse" class="navbar-collapse collapse">
                        <!-- Main navigation -->
                        <ul class="nav navbar-nav">
                            <li class="dropdown">
                                <a href="#" class="nav-link dropdown-toggle" data-toggle="dropdown">Getting Started <b class="caret"></b></a>
                                <ul class="dropdown-menu">
                                    
<li>
    <a href="../../getting-started/" class="dropdown-item">Installation</a>
</li>
                                    
<li>
    <a href="../../configuration-file/" class="dropdown-item">Configuration</a>
</li>
                                    
<li>
    <a href="../../results/" class="dropdown-item">Results</a>
</li>
                                    
<li>
    <a href="../../architecture/" class="dropdown-item">Architecture</a>
</li>
                                    
<li>
    <a href="../../changes/" class="dropdown-item">Changes in v1.3.0</a>
</li>
                                    
  <li class="dropdown-submenu">
    <a href="#" class="dropdown-item">Usage</a>
    <ul class="dropdown-menu">
            
<li>
    <a href="../../usage/commands/" class="dropdown-item">KICS Commands</a>
</li>
            
<li>
    <a href="../../usage/technologies/" class="dropdown-item">Technologies</a>
</li>
    </ul>
  </li>
                                </ul>
                            </li>
                            <li class="dropdown active">
                                <a href="#" class="nav-link dropdown-toggle" data-toggle="dropdown">Queries <b class="caret"></b></a>
                                <ul class="dropdown-menu">
                                    
<li>
    <a href="../" class="dropdown-item">General Info</a>
</li>
                                    
<li>
    <a href="../../creating-queries/" class="dropdown-item">Creating Queries</a>
</li>
                                    
  <li class="dropdown-submenu">
    <a href="#" class="dropdown-item">Queries List</a>
    <ul class="dropdown-menu">
            
<li>
    <a href="../all-queries/" class="dropdown-item">All</a>
</li>
            
<li>
    <a href="../ansible-queries/" class="dropdown-item">Ansible</a>
</li>
            
<li>
    <a href="../cloudformation-queries/" class="dropdown-item">CloudFormation</a>
</li>
            
<li>
    <a href="../common-queries/" class="dropdown-item">Common</a>
</li>
            
<li>
    <a href="./" class="dropdown-item active">Dockerfile</a>
</li>
            
<li>
    <a href="../kubernetes-queries/" class="dropdown-item">Kubernetes</a>
</li>
            
<li>
    <a href="../terraform-queries/" class="dropdown-item">Terraform</a>
</li>
            
<li>
    <a href="../openapi-queries/" class="dropdown-item">OpenAPI</a>
</li>
    </ul>
  </li>
                                </ul>
                            </li>
                            <li class="dropdown">
                                <a href="#" class="nav-link dropdown-toggle" data-toggle="dropdown">Integrations <b class="caret"></b></a>
                                <ul class="dropdown-menu">
                                    
<li>
    <a href="../../integrations/" class="dropdown-item">Overview</a>
</li>
                                    
<li>
    <a href="../../integrations_azurepipelines/" class="dropdown-item">Azure DevOps</a>
</li>
                                    
<li>
    <a href="../../integrations_bitbucketpipelines/" class="dropdown-item">Bitbucket Pipelines</a>
</li>
                                    
<li>
    <a href="../../integrations_circleci/" class="dropdown-item">CircleCI</a>
</li>
                                    
<li>
    <a href="../../integrations_ghactions/" class="dropdown-item">Github Actions</a>
</li>
                                    
<li>
    <a href="../../integrations_gitlabci/" class="dropdown-item">Gitlab CI</a>
</li>
                                    
<li>
    <a href="../../integrations_jenkins/" class="dropdown-item">Jenkins</a>
</li>
                                </ul>
                            </li>
                            <li class="dropdown">
                                <a href="#" class="nav-link dropdown-toggle" data-toggle="dropdown">Project <b class="caret"></b></a>
                                <ul class="dropdown-menu">
                                    
<li>
    <a href="../../roadmap/" class="dropdown-item">Roadmap</a>
</li>
                                    
<li>
    <a href="https://github.com/Checkmarx/kics/projects" class="dropdown-item">Plans</a>
</li>
                                    
<li>
    <a href="https://github.com/Checkmarx/kics/issues" class="dropdown-item">Issues</a>
</li>
                                    
<li>
    <a href="../../releases/" class="dropdown-item">Releases</a>
</li>
                                    
<li>
    <a href="../../performance/" class="dropdown-item">Performance</a>
</li>
                                </ul>
                            </li>
                            <li class="navitem">
                                <a href="../../CONTRIBUTING/" class="nav-link">Contribution</a>
                            </li>
                            <li class="navitem">
                                <a href="../../about/" class="nav-link">About</a>
                            </li>
                        </ul>

                    <ul class="nav navbar-nav ml-auto">
                        <li class="nav-item">
                            <a href="#" class="nav-link" data-toggle="modal" data-target="#mkdocs_search_modal">
                                <i class="fa fa-search"></i> Search
                            </a>
                        </li>
                            <li class="nav-item">
                                <a rel="prev" href="../common-queries/" class="nav-link">
                                    <i class="fa fa-arrow-left"></i> Previous
                                </a>
                            </li>
                            <li class="nav-item">
                                <a rel="next" href="../kubernetes-queries/" class="nav-link">
                                    Next <i class="fa fa-arrow-right"></i>
                                </a>
                            </li>
                            <li class="nav-item">
                                <a href="https://github.com/Checkmarx/kics/edit/master/docs/queries/dockerfile-queries.md" class="nav-link"><i class="fa fa-github"></i> Edit on GitHub</a>
                            </li>
                    </ul>
                </div>
            </div>
        </div>

        <div class="container">
            <div class="row">
                    <div class="col-md-3"><div class="navbar-light navbar-expand-md bs-sidebar hidden-print affix" role="complementary">
    <div class="navbar-header">
        <button type="button" class="navbar-toggler collapsed" data-toggle="collapse" data-target="#toc-collapse" title="Table of Contents">
            <span class="fa fa-angle-down"></span>
        </button>
    </div>

    
    <div id="toc-collapse" class="navbar-collapse collapse card bg-secondary">
        <ul class="nav flex-column">
            
            <li class="nav-item" data-level="2"><a href="#dockerfile_queries_list" class="nav-link">Dockerfile Queries List</a>
              <ul class="nav flex-column">
              </ul>
            </li>
        </ul>
    </div>
</div></div>
                    <div class="col-md-9" role="main">

<h2 id="dockerfile_queries_list">Dockerfile Queries List<a class="headerlink" href="#dockerfile_queries_list" title="Permanent link">&para;</a></h2>
<p>This page contains all queries from Dockerfile.</p>
<table>
<thead>
<tr>
<th>Query</th>
<th>Severity</th>
<th>Category</th>
<th>Description</th>
<th>Help</th>
</tr>
</thead>
<tbody>
<tr>
<td>UNIX Ports Out Of Range<br/><sup><sub>71bf8cf8-f0a1-42fa-b9d2-d10525e0a38e</sub></sup></td>
<td><span style="color:#C00">High</span></td>
<td>Availability</td>
<td>Exposing UNIX ports out of range from 0 to 65535</td>
<td><a href="https://docs.docker.com/engine/reference/builder/#expose">Documentation</a><br/></td>
</tr>
<tr>
<td>Copy With More Than Two Arguments Not Ending With Slash<br/><sup><sub>6db6e0c2-32a3-4a2e-93b5-72c35f4119db</sub></sup></td>
<td><span style="color:#C00">High</span></td>
<td>Build Process</td>
<td>When a COPY command has more than two arguments, the last one should end with a slash</td>
<td><a href="https://docs.docker.com/engine/reference/builder/#copy">Documentation</a><br/></td>
</tr>
<tr>
<td>Same Alias In Different Froms<br/><sup><sub>f2daed12-c802-49cd-afed-fe41d0b82fed</sub></sup></td>
<td><span style="color:#C00">High</span></td>
<td>Build Process</td>
<td>Different FROMS cant have the same alias defined</td>
<td><a href="https://docs.docker.com/develop/develop-images/multistage-build/">Documentation</a><br/></td>
</tr>
<tr>
<td>COPY '--from' References Current FROM Alias<br/><sup><sub>cdddb86f-95f6-4fc4-b5a1-483d9afceb2b</sub></sup></td>
<td><span style="color:#C00">High</span></td>
<td>Build Process</td>
<td>COPY '--from' should not mention the current FROM alias, since it is impossible to copy from itself</td>
<td><a href="https://docs.docker.com/develop/develop-images/multistage-build/">Documentation</a><br/></td>
</tr>
<tr>
<td>Missing User Instruction<br/><sup><sub>fd54f200-402c-4333-a5a4-36ef6709af2f</sub></sup></td>
<td><span style="color:#C00">High</span></td>
<td>Build Process</td>
<td>A user should be specified in the dockerfile, otherwise the image will run as root</td>
<td><a href="https://docs.docker.com/engine/reference/builder/#user">Documentation</a><br/></td>
</tr>
<tr>
<td>Multiple ENTRYPOINT Instructions Listed<br/><sup><sub>6938958b-3f1a-451c-909b-baeee14bdc97</sub></sup></td>
<td><span style="color:#C00">High</span></td>
<td>Build Process</td>
<td>There can only be one ENTRYPOINT instruction in a Dockerfile. Only the last ENTRYPOINT instruction in the Dockerfile will have an effect</td>
<td><a href="https://docs.docker.com/engine/reference/builder/#entrypoint">Documentation</a><br/></td>
</tr>
<tr>
<td>WORKDIR Path Not Absolute<br/><sup><sub>6b376af8-cfe8-49ab-a08d-f32de23661a4</sub></sup></td>
<td><span style="color:#C00">High</span></td>
<td>Build Process</td>
<td>For clarity and reliability, you should always use absolute paths for your WORKDIR</td>
<td><a href="https://docs.docker.com/develop/develop-images/dockerfile_best-practices/#workdir">Documentation</a><br/></td>
</tr>
<tr>
<td>Run Using Sudo<br/><sup><sub>8ada6e80-0ade-439e-b176-0b28f6bce35a</sub></sup></td>
<td><span style="color:#C00">High</span></td>
<td>Insecure Configurations</td>
<td>Avoid RUN with sudo command as it leads to unpredictable behavior</td>
<td><a href="https://docs.docker.com/engine/reference/builder/#run">Documentation</a><br/></td>
</tr>
<tr>
<td>Use of Apk Upgrade<br/><sup><sub>989ab888-7d1e-410f-9dde-c64a1d367bf2</sub></sup></td>
<td><span style="color:#C00">High</span></td>
<td>Supply-Chain</td>
<td>Avoid usage of apk upgrade because some packages from the parent image cannot be upgraded inside an unprivileged container</td>
<td><a href="https://docs.docker.com/develop/develop-images/dockerfile_best-practices/#run">Documentation</a><br/></td>
</tr>
<tr>
<td>Yum Update Enabled<br/><sup><sub>8f6456be-0018-46db-9ce6-b3b6dc8d34d2</sub></sup></td>
<td><span style="color:#C00">High</span></td>
<td>Supply-Chain</td>
<td>Yum update is being used</td>
<td><a href="https://docs.docker.com/engine/install/centos/#upgrade-docker-engine-1">Documentation</a><br/></td>
</tr>
<tr>
<td>Run Using Upgrade Commands<br/><sup><sub>682fe378-c180-4bd5-8a14-95fc285fb269</sub></sup></td>
<td><span style="color:#C00">High</span></td>
<td>Supply-Chain</td>
<td>Commands 'apt-get upgrade' and 'apt-get dist-upgrade' should not be used</td>
<td><a href="https://docs.docker.com/develop/develop-images/dockerfile_best-practices/">Documentation</a><br/></td>
</tr>
<tr>
<td>Run Using dnf Update<br/><sup><sub>09fda05e-da85-4ee7-ab8d-2800a5e6e756</sub></sup></td>
<td><span style="color:#C00">High</span></td>
<td>Supply-Chain</td>
<td>Command 'dnf update' should not be used, as it can cause inconsistencies between builds and fails in updated packages</td>
<td><a href="https://docs.docker.com/develop/develop-images/dockerfile_best-practices/#run">Documentation</a><br/></td>
</tr>
<tr>
<td>Last User Is 'root'<br/><sup><sub>67fd0c4a-68cf-46d7-8c41-bc9fba7e40ae</sub></sup></td>
<td><span style="color:#C60">Medium</span></td>
<td>Best Practices</td>
<td>Leaving the last user as root can cause security risks. Change to another user after running the commands the need privileges</td>
<td><a href="https://docs.docker.com/engine/reference/builder/#user">Documentation</a><br/></td>
</tr>
<tr>
<td>COPY '--from' Without FROM Alias Defined Previously<br/><sup><sub>68a51e22-ae5a-4d48-8e87-b01a323605c9</sub></sup></td>
<td><span style="color:#C60">Medium</span></td>
<td>Build Process</td>
<td>COPY command with the flag '--from' should mention a previously defined FROM alias</td>
<td><a href="https://docs.docker.com/develop/develop-images/multistage-build/">Documentation</a><br/></td>
</tr>
<tr>
<td>Update Instruction Alone<br/><sup><sub>9bae49be-0aa3-4de5-bab2-4c3a069e40cd</sub></sup></td>
<td><span style="color:#C60">Medium</span></td>
<td>Build Process</td>
<td>Instruction 'RUN <package-manager> update' should always be followed by '<package-manager> install' in the same RUN statement</td>
<td><a href="https://docs.docker.com/develop/develop-images/dockerfile_best-practices/#run">Documentation</a><br/></td>
</tr>
<tr>
<td>Not Using JSON In CMD And ENTRYPOINT Arguments<br/><sup><sub>b86987e1-6397-4619-81d5-8807f2387c79</sub></sup></td>
<td><span style="color:#C60">Medium</span></td>
<td>Build Process</td>
<td>Ensure that we are using JSON in the CMD and ENTRYPOINT Arguments</td>
<td><a href="https://docs.docker.com/engine/reference/builder/#entrypoint">Documentation</a><br/></td>
</tr>
<tr>
<td>RUN Instruction Using 'cd' Instead of WORKDIR<br/><sup><sub>f4a6bcd3-e231-4acf-993c-aa027be50d2e</sub></sup></td>
<td><span style="color:#C60">Medium</span></td>
<td>Build Process</td>
<td>Use WORKDIR instead of proliferating instructions like RUN cd â€¦ &amp;&amp; do-something, which are hard to read, troubleshoot, and maintain.</td>
<td><a href="https://docs.docker.com/develop/develop-images/dockerfile_best-practices/#workdir">Documentation</a><br/></td>
</tr>
<tr>
<td>Multiple CMD Instructions Listed<br/><sup><sub>41c195f4-fc31-4a5c-8a1b-90605538d49f</sub></sup></td>
<td><span style="color:#C60">Medium</span></td>
<td>Build Process</td>
<td>There can only be one CMD instruction in a Dockerfile. If you list more than one CMD then only the last CMD will take effect</td>
<td><a href="https://docs.docker.com/engine/reference/builder/#cmd">Documentation</a><br/></td>
</tr>
<tr>
<td>Changing Default Shell Using SHELL Command<br/><sup><sub>8a301064-c291-4b20-adcb-403fe7fd95fd</sub></sup></td>
<td><span style="color:#C60">Medium</span></td>
<td>Insecure Defaults</td>
<td>Using the command SHELL to override the default shell instead of the RUN command</td>
<td><a href="https://docs.docker.com/engine/reference/builder/#shell">Documentation</a><br/></td>
</tr>
<tr>
<td>Shell Running A Pipe Without Pipefail Flag<br/><sup><sub>efbf148a-67e9-42d2-ac47-02fa1c0d0b22</sub></sup></td>
<td><span style="color:#C60">Medium</span></td>
<td>Insecure Defaults</td>
<td>Check if shell commands with pipes (except Powershell) have the pipefail flag set (-o).</td>
<td><a href="https://docs.docker.com/engine/reference/builder/#run">Documentation</a><br/></td>
</tr>
<tr>
<td>Secrets Stored In Dockerfile<br/><sup><sub>c3e1b6ae-d92c-44b3-8ed5-1f5442bab6a4</sub></sup></td>
<td><span style="color:#C60">Medium</span></td>
<td>Secret Management</td>
<td>Scan Dockerfile to ensure that there are no secrets stored</td>
<td><a href="https://docs.docker.com/develop/develop-images/dockerfile_best-practices/#env">Documentation</a><br/></td>
</tr>
<tr>
<td>Run Using apt<br/><sup><sub>b84a0b47-2e99-4c9f-8933-98bcabe2b94d</sub></sup></td>
<td><span style="color:#C60">Medium</span></td>
<td>Supply-Chain</td>
<td>apt is discouraged by the linux distributions as an unattended tool as its interface may suffer changes between versions. Better use the more stable apt-get and apt-cache</td>
<td><a href="https://docs.docker.com/develop/develop-images/dockerfile_best-practices/#run">Documentation</a><br/></td>
</tr>
<tr>
<td>Missing Zypper Non-interactive Switch<br/><sup><sub>45e1fca5-f90e-465d-825f-c2cb63fa3944</sub></sup></td>
<td><span style="color:#C60">Medium</span></td>
<td>Supply-Chain</td>
<td>Omitting the non-interactive switch causes the command to fail during the build process, because zypper would expect manual input</td>
<td><a href="https://docs.docker.com/develop/develop-images/dockerfile_best-practices/#run">Documentation</a><br/></td>
</tr>
<tr>
<td>Pip install Keeping Cached Packages<br/><sup><sub>f2f903fb-b977-461e-98d7-b3e2185c6118</sub></sup></td>
<td><span style="color:#C60">Medium</span></td>
<td>Supply-Chain</td>
<td>When installing packages with pip, the '--no-cache-dir' flag should be set to make Docker images smaller</td>
<td><a href="https://docs.docker.com/develop/develop-images/dockerfile_best-practices/">Documentation</a><br/></td>
</tr>
<tr>
<td>Using Platform Flag with FROM Command<br/><sup><sub>b16e8501-ef3c-44e1-a543-a093238099c9</sub></sup></td>
<td><span style="color:#C60">Medium</span></td>
<td>Supply-Chain</td>
<td>Don't use '--platform' flag with FROM</td>
<td><a href="https://docs.docker.com/engine/reference/builder/#from">Documentation</a><br/></td>
</tr>
<tr>
<td>Image Version Using 'latest'<br/><sup><sub>f45ea400-6bbe-4501-9fc7-1c3d75c32067</sub></sup></td>
<td><span style="color:#C60">Medium</span></td>
<td>Supply-Chain</td>
<td>When building images, always tag them with useful tags which codify version information, intended destination (prod or test, for instance), stability, or other information that is useful when deploying the application in different environments. Do not rely on the automatically-created latest tag</td>
<td><a href="https://docs.docker.com/develop/dev-best-practices/">Documentation</a><br/></td>
</tr>
<tr>
<td>Run Using Zypper Update<br/><sup><sub>d4895357-dd49-4ba5-b726-1bb81cb50989</sub></sup></td>
<td><span style="color:#C60">Medium</span></td>
<td>Supply-Chain</td>
<td>'zypper update' should not be used. Can cause inconsistencies between builds, producing problems for application developers</td>
<td><a href="https://docs.docker.com/develop/develop-images/dockerfile_best-practices/#run">Documentation</a><br/></td>
</tr>
<tr>
<td>Gem Install Without Version<br/><sup><sub>22cd11f7-9c6c-4f6e-84c0-02058120b341</sub></sup></td>
<td><span style="color:#C60">Medium</span></td>
<td>Supply-Chain</td>
<td>Instead of 'gem install <gem>' we should use 'gem install <gem>:<version>'</td>
<td><a href="https://docs.docker.com/develop/develop-images/dockerfile_best-practices/#run">Documentation</a><br/></td>
</tr>
<tr>
<td>Missing Zypper Clean<br/><sup><sub>38300d1a-feb2-4a48-936a-d1ef1cd24313</sub></sup></td>
<td><span style="color:#C60">Medium</span></td>
<td>Supply-Chain</td>
<td>Reduce layer and image size by deleting unneeded caches after running zypper</td>
<td><a href="https://docs.docker.com/develop/develop-images/dockerfile_best-practices/#run">Documentation</a><br/></td>
</tr>
<tr>
<td>Yum Install Allows Manual Input<br/><sup><sub>6e19193a-8753-436d-8a09-76dcff91bb03</sub></sup></td>
<td><span style="color:#C60">Medium</span></td>
<td>Supply-Chain</td>
<td>Need to use -y to avoid manual input 'yum install -y <package>'</td>
<td><a href="https://docs.docker.com/engine/reference/builder/#run">Documentation</a><br/></td>
</tr>
<tr>
<td>Run Using 'wget' and 'curl'<br/><sup><sub>fc775e75-fcfb-4c98-b2f2-910c5858b359</sub></sup></td>
<td><span style="color:#C60">Medium</span></td>
<td>Supply-Chain</td>
<td>Shouldn't use both 'wget' and 'curl' since they are two tools that have the same effect</td>
<td><a href="https://docs.docker.com/develop/develop-images/dockerfile_best-practices/#run">Documentation</a><br/></td>
</tr>
<tr>
<td>Unpinned Package Version in Apk Add<br/><sup><sub>d3499f6d-1651-41bb-a9a7-de925fea487b</sub></sup></td>
<td><span style="color:#C60">Medium</span></td>
<td>Supply-Chain</td>
<td>Package version pinning reduces the range of versions that can be installed, reducing the chances of failure due to unanticipated changes</td>
<td><a href="https://docs.docker.com/develop/develop-images/dockerfile_best-practices/">Documentation</a><br/></td>
</tr>
<tr>
<td>Yum Clean All Missing<br/><sup><sub>00481784-25aa-4a55-8633-3136dfcf4f37</sub></sup></td>
<td><span style="color:#C60">Medium</span></td>
<td>Supply-Chain</td>
<td>Need to use 'yum clean all' after using a 'yum install' command to clean package cached data and reduce image size</td>
<td><a href="https://docs.docker.com/develop/develop-images/dockerfile_best-practices/#run">Documentation</a><br/></td>
</tr>
<tr>
<td>Missing Dnf Clean All<br/><sup><sub>295acb63-9246-4b21-b441-7c1f1fb62dc0</sub></sup></td>
<td><span style="color:#C60">Medium</span></td>
<td>Supply-Chain</td>
<td>Cached package data should be cleaned after installation to reduce image size</td>
<td><a href="https://docs.docker.com/develop/develop-images/dockerfile_best-practices/">Documentation</a><br/></td>
</tr>
<tr>
<td>Apt Get Install Pin Version Not Defined<br/><sup><sub>965a08d7-ef86-4f14-8792-4a3b2098937e</sub></sup></td>
<td><span style="color:#C60">Medium</span></td>
<td>Supply-Chain</td>
<td>When installing a package, its pin version should be defined</td>
<td><a href="https://docs.docker.com/develop/develop-images/dockerfile_best-practices/">Documentation</a><br/></td>
</tr>
<tr>
<td>APT-GET Missing '-y' To Avoid Manual Input<br/><sup><sub>77783205-c4ca-4f80-bb80-c777f267c547</sub></sup></td>
<td><span style="color:#C60">Medium</span></td>
<td>Supply-Chain</td>
<td>Check if apt-get calls use the flag -y to avoid user manual input.</td>
<td><a href="https://docs.docker.com/engine/reference/builder/#run">Documentation</a><br/></td>
</tr>
<tr>
<td>Unpinned Package Version in Pip Install<br/><sup><sub>02d9c71f-3ee8-4986-9c27-1a20d0d19bfc</sub></sup></td>
<td><span style="color:#C60">Medium</span></td>
<td>Supply-Chain</td>
<td>Package version pinning reduces the range of versions that can be installed, reducing the chances of failure due to unanticipated changes</td>
<td><a href="https://docs.docker.com/develop/develop-images/dockerfile_best-practices/">Documentation</a><br/></td>
</tr>
<tr>
<td>Missing Flag From Dnf Install<br/><sup><sub>7ebd323c-31b7-4e5b-b26f-de5e9e477af8</sub></sup></td>
<td><span style="color:#C60">Medium</span></td>
<td>Supply-Chain</td>
<td>The '-y' or '--assumeyes' flag should be added when invoking dnf install. If omitted, it can cause the command to fail during the build process, because dnf would expect manual input.</td>
<td><a href="https://docs.docker.com/develop/develop-images/dockerfile_best-practices/#run">Documentation</a><br/></td>
</tr>
<tr>
<td>Image Version Not Explicit<br/><sup><sub>9efb0b2d-89c9-41a3-91ca-dcc0aec911fd</sub></sup></td>
<td><span style="color:#C60">Medium</span></td>
<td>Supply-Chain</td>
<td>Always tag the version of an image explicitly</td>
<td><a href="https://docs.docker.com/engine/reference/builder/#from">Documentation</a><br/></td>
</tr>
<tr>
<td>NPM Install Command Without Pinned Version<br/><sup><sub>e36d8880-3f78-4546-b9a1-12f0745ca0d5</sub></sup></td>
<td><span style="color:#C60">Medium</span></td>
<td>Supply-Chain</td>
<td>Check if packages installed by npm are pinning a specific version.</td>
<td><a href="https://docs.docker.com/engine/reference/builder/#run">Documentation</a><br/></td>
</tr>
<tr>
<td>Zypper Install Without Version<br/><sup><sub>562952e4-0348-4dea-9826-44f3a2c6117b</sub></sup></td>
<td><span style="color:#C60">Medium</span></td>
<td>Supply-Chain</td>
<td>Not specifying the package version can cause failures due to unanticipated changes in required packages</td>
<td><a href="https://docs.docker.com/develop/develop-images/dockerfile_best-practices/#run">Documentation</a><br/></td>
</tr>
<tr>
<td>Yum install Without Version<br/><sup><sub>6452c424-1d92-4deb-bb18-a03e95d579c4</sub></sup></td>
<td><span style="color:#C60">Medium</span></td>
<td>Supply-Chain</td>
<td>Not specifying the package version can cause failures due to unanticipated changes in required packages</td>
<td><a href="https://docs.docker.com/develop/develop-images/dockerfile_best-practices/#run">Documentation</a><br/></td>
</tr>
<tr>
<td>Missing Version Specification In dnf install<br/><sup><sub>93d88cf7-f078-46a8-8ddc-178e03aeacf1</sub></sup></td>
<td><span style="color:#C60">Medium</span></td>
<td>Supply-Chain</td>
<td>Specifying a package version allows to reduce failures due to unanticipated changes in required packages.</td>
<td><a href="https://docs.docker.com/develop/develop-images/dockerfile_best-practices/">Documentation</a><br/></td>
</tr>
<tr>
<td>Chown Flag Exists<br/><sup><sub>aa93e17f-b6db-4162-9334-c70334e7ac28</sub></sup></td>
<td><span style="color:#CC0">Low</span></td>
<td>Best Practices</td>
<td>If the user only needs execution permissions on the file and not ownership, don't use --chown option</td>
<td><a href="https://docs.docker.com/develop/develop-images/dockerfile_best-practices/">Documentation</a><br/></td>
</tr>
<tr>
<td>Exposing Port 22 (SSH)<br/><sup><sub>5907595b-5b6d-4142-b173-dbb0e73fbff8</sub></sup></td>
<td><span style="color:#CC0">Low</span></td>
<td>Best Practices</td>
<td>Expose only the ports that your application needs and avoid exposing ports like SSH (22)</td>
<td><a href="https://sysdig.com/blog/dockerfile-best-practices/">Documentation</a><br/></td>
</tr>
<tr>
<td>MAINTAINER Instruction Being Used<br/><sup><sub>99614418-f82b-4852-a9ae-5051402b741c</sub></sup></td>
<td><span style="color:#CC0">Low</span></td>
<td>Best Practices</td>
<td>The MAINTAINER instruction sets the Author field of the generated images. The LABEL instruction is a much more flexible version of this and you should use it instead, as it enables setting any metadata you require, and can be viewed easily</td>
<td><a href="https://docs.docker.com/engine/reference/builder/#maintainer-deprecated">Documentation</a><br/></td>
</tr>
<tr>
<td>Curl or Wget Instead of Add<br/><sup><sub>4b410d24-1cbe-4430-a632-62c9a931cf1c</sub></sup></td>
<td><span style="color:#CC0">Low</span></td>
<td>Best Practices</td>
<td>Use Curl or Wget instead of Add to fetch packages from remote URLs, because using Add is strongly discouraged</td>
<td><a href="https://docs.docker.com/develop/develop-images/dockerfile_best-practices/">Documentation</a><br/></td>
</tr>
<tr>
<td>Multiple RUN, ADD, COPY, Instructions Listed<br/><sup><sub>0008c003-79aa-42d8-95b8-1c2fe37dbfe6</sub></sup></td>
<td><span style="color:#CC0">Low</span></td>
<td>Best Practices</td>
<td>Multiple commands (RUN, Copy, And) should be grouped in order to reduce the number of layers.</td>
<td><a href="https://sysdig.com/blog/dockerfile-best-practices/">Documentation</a><br/></td>
</tr>
<tr>
<td>Add Instead of Copy<br/><sup><sub>9513a694-aa0d-41d8-be61-3271e056f36b</sub></sup></td>
<td><span style="color:#CC0">Low</span></td>
<td>Build Process</td>
<td>Should use COPY instead of ADD unless, running a tar file</td>
<td><a href="https://docs.docker.com/engine/reference/builder/#add">Documentation</a><br/></td>
</tr>
<tr>
<td>Healthcheck Instruction Missing<br/><sup><sub>b03a748a-542d-44f4-bb86-9199ab4fd2d5</sub></sup></td>
<td><span style="color:#CC0">Low</span></td>
<td>Insecure Configurations</td>
<td>Ensure that HEALTHCHECK is being used. The HEALTHCHECK instruction tells Docker how to test a container to check that it is still working</td>
<td><a href="https://docs.docker.com/engine/reference/builder/#healthcheck">Documentation</a><br/></td>
</tr>
<tr>
<td>Apt Get Install Lists Were Not Deleted<br/><sup><sub>df746b39-6564-4fed-bf85-e9c44382303c</sub></sup></td>
<td><span style="color:#00C">Info</span></td>
<td>Supply-Chain</td>
<td>After using apt-get install, it is needed to delete apt-get lists</td>
<td><a href="https://docs.docker.com/develop/develop-images/dockerfile_best-practices/">Documentation</a><br/></td>
</tr>
<tr>
<td>Run Utilities And POSIX Commands<br/><sup><sub>9b6b0f38-92a2-41f9-b881-3a1083d99f1b</sub></sup></td>
<td><span style="color:#00C">Info</span></td>
<td>Supply-Chain</td>
<td>Some POSIX commands and interactive utilities shouldn't run inside a Docker Container</td>
<td><a href="https://docs.docker.com/engine/reference/builder/#run">Documentation</a><br/></td>
</tr>
<tr>
<td>APT-GET Not Avoiding Additional Packages<br/><sup><sub>7384dfb2-fcd1-4fbf-91cd-6c44c318c33c</sub></sup></td>
<td><span style="color:#00C">Info</span></td>
<td>Supply-Chain</td>
<td>Check if any apt-get installs don't use '--no-install-recommends' flag to avoid installing additional packages.</td>
<td><a href="https://docs.docker.com/engine/reference/builder/#run">Documentation</a><br/></td>
</tr>
<tr>
<td>Apk Add Using Local Cache Path<br/><sup><sub>ae9c56a6-3ed1-4ac0-9b54-31267f51151d</sub></sup></td>
<td><span style="color:#00C">Info</span></td>
<td>Supply-Chain</td>
<td>When installing packages, use the '--no-cache' switch to avoid the need to use '--update' and remove '/var/cache/apk/*'</td>
<td><a href="https://docs.docker.com/engine/reference/builder/#run">Documentation</a><br/></td>
</tr>
</tbody>
</table></div>
            </div>
        </div>

        <footer class="col-md-12">
            <hr>
                <p>&copy; 2021 Checkmarx Ltd. All Rights Reserved.</p>
            <p>Documentation built with <a href="https://www.mkdocs.org/">MkDocs</a>.</p>
        </footer>
        <script>
            var base_url = "../..",
                shortcuts = {"help": 191, "next": 78, "previous": 80, "search": 83};
        </script>
        <script src="../../js/base.js" defer></script>
        <script src="../../js/custom.js" defer></script>
        <script src="../../js/version-mike.js" defer></script>
        <script src="../../search/main.js" defer></script>

        <div class="modal" id="mkdocs_search_modal" tabindex="-1" role="dialog" aria-labelledby="searchModalLabel" aria-hidden="true">
    <div class="modal-dialog modal-lg">
        <div class="modal-content">
            <div class="modal-header">
                <h4 class="modal-title" id="searchModalLabel">Search</h4>
                <button type="button" class="close" data-dismiss="modal"><span aria-hidden="true">&times;</span><span class="sr-only">Close</span></button>
            </div>
            <div class="modal-body">
                <p>
                    From here you can search these documents. Enter
                    your search terms below.
                </p>
                <form>
                    <div class="form-group">
                        <input type="search" class="form-control" placeholder="Search..." id="mkdocs-search-query" title="Type search term here">
                    </div>
                </form>
                <div id="mkdocs-search-results"></div>
            </div>
            <div class="modal-footer">
            </div>
        </div>
    </div>
</div><div class="modal" id="mkdocs_keyboard_modal" tabindex="-1" role="dialog" aria-labelledby="keyboardModalLabel" aria-hidden="true">
    <div class="modal-dialog">
        <div class="modal-content">
            <div class="modal-header">
                <h4 class="modal-title" id="keyboardModalLabel">Keyboard Shortcuts</h4>
                <button type="button" class="close" data-dismiss="modal"><span aria-hidden="true">&times;</span><span class="sr-only">Close</span></button>
            </div>
            <div class="modal-body">
              <table class="table">
                <thead>
                  <tr>
                    <th style="width: 20%;">Keys</th>
                    <th>Action</th>
                  </tr>
                </thead>
                <tbody>
                  <tr>
                    <td class="help shortcut"><kbd>?</kbd></td>
                    <td>Open this help</td>
                  </tr>
                  <tr>
                    <td class="next shortcut"><kbd>n</kbd></td>
                    <td>Next page</td>
                  </tr>
                  <tr>
                    <td class="prev shortcut"><kbd>p</kbd></td>
                    <td>Previous page</td>
                  </tr>
                  <tr>
                    <td class="search shortcut"><kbd>s</kbd></td>
                    <td>Search</td>
                  </tr>
                </tbody>
              </table>
            </div>
            <div class="modal-footer">
            </div>
        </div>
    </div>
</div>

    </body>
</html>
