
<!doctype html>
<html lang="en" class="no-js">
  <head>
    
      <meta charset="utf-8">
      <meta name="viewport" content="width=device-width,initial-scale=1">
      
        <meta name="description" content="Open source solution for static code analysis of Infrastructure as Code. Finding security vulnerabilities, compliance issues, and infrastructure misconfigurations during project development cycle.">
      
      
      
        <link rel="canonical" href="http://docs.kics.io/develop/creating-queries/">
      
      <link rel="icon" href="../img/logo/kics-hat.ico">
      <meta name="generator" content="mkdocs-1.4.1, mkdocs-material-8.5.7">
    
    
      
        <title>Creating Queries - KICS</title>
      
    
    
      <link rel="stylesheet" href="../assets/stylesheets/main.20d9efc8.min.css">
      
        
        <link rel="stylesheet" href="../assets/stylesheets/palette.cbb835fc.min.css">
        
      
      

    
    
    
      
        
        
        <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
        <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Roboto:300,300i,400,400i,700,700i%7CRoboto+Mono:400,400i,700,700i&display=fallback">
        <style>:root{--md-text-font:"Roboto";--md-code-font:"Roboto Mono"}</style>
      
    
    
      <link rel="stylesheet" href="../css/custom.css">
    
    <script>__md_scope=new URL("..",location),__md_hash=e=>[...e].reduce((e,_)=>(e<<5)-e+_.charCodeAt(0),0),__md_get=(e,_=localStorage,t=__md_scope)=>JSON.parse(_.getItem(t.pathname+"."+e)),__md_set=(e,_,t=localStorage,a=__md_scope)=>{try{t.setItem(a.pathname+"."+e,JSON.stringify(_))}catch(e){}}</script>
    
      

    
    
    
  </head>
  
  
    
    
      
    
    
    
    
    <body dir="ltr" data-md-color-scheme="kics" data-md-color-primary="" data-md-color-accent="">
  
    
    
      <script>var palette=__md_get("__palette");if(palette&&"object"==typeof palette.color)for(var key of Object.keys(palette.color))document.body.setAttribute("data-md-color-"+key,palette.color[key])</script>
    
    <input class="md-toggle" data-md-toggle="drawer" type="checkbox" id="__drawer" autocomplete="off">
    <input class="md-toggle" data-md-toggle="search" type="checkbox" id="__search" autocomplete="off">
    <label class="md-overlay" for="__drawer"></label>
    <div data-md-component="skip">
      
        
        <a href="#create_a_new_query" class="md-skip">
          Skip to content
        </a>
      
    </div>
    <div data-md-component="announce">
      
    </div>
    
      <div data-md-component="outdated" hidden>
        
      </div>
    
    
      

  

<header class="md-header md-header--lifted" data-md-component="header">
  <nav class="md-header__inner md-grid" aria-label="Header">
    <a href=".." title="KICS" class="md-header__button md-logo" aria-label="KICS" data-md-component="logo">
      
  <img src="../img/logo/kics_hat_color_new.png" alt="logo">

    </a>
    <label class="md-header__button md-icon" for="__drawer">
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M3 6h18v2H3V6m0 5h18v2H3v-2m0 5h18v2H3v-2Z"/></svg>
    </label>
    <div class="md-header__title" data-md-component="header-title">
      <div class="md-header__ellipsis">
        <div class="md-header__topic">
          <span class="md-ellipsis">
            KICS
          </span>
        </div>
        <div class="md-header__topic" data-md-component="header-topic">
          <span class="md-ellipsis">
            
              Creating Queries
            
          </span>
        </div>
      </div>
    </div>
    
      <form class="md-header__option" data-md-component="palette">
        
          
          
          <input class="md-option" data-md-color-media="" data-md-color-scheme="kics" data-md-color-primary="" data-md-color-accent=""  aria-label="Switch to dark mode"  type="radio" name="__palette" id="__palette_1">
          
            <label class="md-header__button md-icon" title="Switch to dark mode" for="__palette_2" hidden>
              <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="m17.75 4.09-2.53 1.94.91 3.06-2.63-1.81-2.63 1.81.91-3.06-2.53-1.94L12.44 4l1.06-3 1.06 3 3.19.09m3.5 6.91-1.64 1.25.59 1.98-1.7-1.17-1.7 1.17.59-1.98L15.75 11l2.06-.05L18.5 9l.69 1.95 2.06.05m-2.28 4.95c.83-.08 1.72 1.1 1.19 1.85-.32.45-.66.87-1.08 1.27C15.17 23 8.84 23 4.94 19.07c-3.91-3.9-3.91-10.24 0-14.14.4-.4.82-.76 1.27-1.08.75-.53 1.93.36 1.85 1.19-.27 2.86.69 5.83 2.89 8.02a9.96 9.96 0 0 0 8.02 2.89m-1.64 2.02a12.08 12.08 0 0 1-7.8-3.47c-2.17-2.19-3.33-5-3.49-7.82-2.81 3.14-2.7 7.96.31 10.98 3.02 3.01 7.84 3.12 10.98.31Z"/></svg>
            </label>
          
        
          
          
          <input class="md-option" data-md-color-media="" data-md-color-scheme="slate" data-md-color-primary="" data-md-color-accent=""  aria-label="Switch to light mode"  type="radio" name="__palette" id="__palette_2">
          
            <label class="md-header__button md-icon" title="Switch to light mode" for="__palette_1" hidden>
              <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 7a5 5 0 0 1 5 5 5 5 0 0 1-5 5 5 5 0 0 1-5-5 5 5 0 0 1 5-5m0 2a3 3 0 0 0-3 3 3 3 0 0 0 3 3 3 3 0 0 0 3-3 3 3 0 0 0-3-3m0-7 2.39 3.42C13.65 5.15 12.84 5 12 5c-.84 0-1.65.15-2.39.42L12 2M3.34 7l4.16-.35A7.2 7.2 0 0 0 5.94 8.5c-.44.74-.69 1.5-.83 2.29L3.34 7m.02 10 1.76-3.77a7.131 7.131 0 0 0 2.38 4.14L3.36 17M20.65 7l-1.77 3.79a7.023 7.023 0 0 0-2.38-4.15l4.15.36m-.01 10-4.14.36c.59-.51 1.12-1.14 1.54-1.86.42-.73.69-1.5.83-2.29L20.64 17M12 22l-2.41-3.44c.74.27 1.55.44 2.41.44.82 0 1.63-.17 2.37-.44L12 22Z"/></svg>
            </label>
          
        
      </form>
    
    
    
      <label class="md-header__button md-icon" for="__search">
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.516 6.516 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5Z"/></svg>
      </label>
      <div class="md-search" data-md-component="search" role="dialog">
  <label class="md-search__overlay" for="__search"></label>
  <div class="md-search__inner" role="search">
    <form class="md-search__form" name="search">
      <input type="text" class="md-search__input" name="query" aria-label="Search" placeholder="Search" autocapitalize="off" autocorrect="off" autocomplete="off" spellcheck="false" data-md-component="search-query" required>
      <label class="md-search__icon md-icon" for="__search">
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.516 6.516 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5Z"/></svg>
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11h12Z"/></svg>
      </label>
      <nav class="md-search__options" aria-label="Search">
        
        <button type="reset" class="md-search__icon md-icon" title="Clear" aria-label="Clear" tabindex="-1">
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M19 6.41 17.59 5 12 10.59 6.41 5 5 6.41 10.59 12 5 17.59 6.41 19 12 13.41 17.59 19 19 17.59 13.41 12 19 6.41Z"/></svg>
        </button>
      </nav>
      
    </form>
    <div class="md-search__output">
      <div class="md-search__scrollwrap" data-md-scrollfix>
        <div class="md-search-result" data-md-component="search-result">
          <div class="md-search-result__meta">
            Initializing search
          </div>
          <ol class="md-search-result__list"></ol>
        </div>
      </div>
    </div>
  </div>
</div>
    
    
      <div class="md-header__source">
        <a href="https://github.com/Checkmarx/kics/" title="Go to repository" class="md-source" data-md-component="source">
  <div class="md-source__icon md-icon">
    
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 448 512"><!--! Font Awesome Free 6.2.0 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2022 Fonticons, Inc.--><path d="M439.55 236.05 244 40.45a28.87 28.87 0 0 0-40.81 0l-40.66 40.63 51.52 51.52c27.06-9.14 52.68 16.77 43.39 43.68l49.66 49.66c34.23-11.8 61.18 31 35.47 56.69-26.49 26.49-70.21-2.87-56-37.34L240.22 199v121.85c25.3 12.54 22.26 41.85 9.08 55a34.34 34.34 0 0 1-48.55 0c-17.57-17.6-11.07-46.91 11.25-56v-123c-20.8-8.51-24.6-30.74-18.64-45L142.57 101 8.45 235.14a28.86 28.86 0 0 0 0 40.81l195.61 195.6a28.86 28.86 0 0 0 40.8 0l194.69-194.69a28.86 28.86 0 0 0 0-40.81z"/></svg>
  </div>
  <div class="md-source__repository">
    GitHub
  </div>
</a>
      </div>
    
  </nav>
  
    
      
<nav class="md-tabs" aria-label="Tabs" data-md-component="tabs">
  <div class="md-tabs__inner md-grid">
    <ul class="md-tabs__list">
      
        
  
  


  
  
  
    <li class="md-tabs__item">
      <a href="../getting-started/" class="md-tabs__link">
        Getting Started
      </a>
    </li>
  

      
        
  
  
    
  


  
  
  
    <li class="md-tabs__item">
      <a href="../queries/" class="md-tabs__link md-tabs__link--active">
        Queries
      </a>
    </li>
  

      
        
  
  


  
  
  
    <li class="md-tabs__item">
      <a href="../integrations/" class="md-tabs__link">
        Integrations
      </a>
    </li>
  

      
        
  
  


  <li class="md-tabs__item">
    <a href="../certifications/" class="md-tabs__link">
      Certifications
    </a>
  </li>

      
        
  
  


  
  
  
    <li class="md-tabs__item">
      <a href="../roadmap/" class="md-tabs__link">
        Project
      </a>
    </li>
  

      
        
  
  


  <li class="md-tabs__item">
    <a href="../CONTRIBUTING/" class="md-tabs__link">
      Contribution
    </a>
  </li>

      
        
  
  


  <li class="md-tabs__item">
    <a href="../community/" class="md-tabs__link">
      Community
    </a>
  </li>

      
        
  
  


  <li class="md-tabs__item">
    <a href="../about/" class="md-tabs__link">
      About
    </a>
  </li>

      
    </ul>
  </div>
</nav>
    
  
</header>
    
    <div class="md-container" data-md-component="container">
      
      
        
      
      <main class="md-main" data-md-component="main">
        <div class="md-main__inner md-grid">
          
            
              
              <div class="md-sidebar md-sidebar--primary" data-md-component="sidebar" data-md-type="navigation" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    

  


<nav class="md-nav md-nav--primary md-nav--lifted" aria-label="Navigation" data-md-level="0">
  <label class="md-nav__title" for="__drawer">
    <a href=".." title="KICS" class="md-nav__button md-logo" aria-label="KICS" data-md-component="logo">
      
  <img src="../img/logo/kics_hat_color_new.png" alt="logo">

    </a>
    KICS
  </label>
  
    <div class="md-nav__source">
      <a href="https://github.com/Checkmarx/kics/" title="Go to repository" class="md-source" data-md-component="source">
  <div class="md-source__icon md-icon">
    
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 448 512"><!--! Font Awesome Free 6.2.0 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2022 Fonticons, Inc.--><path d="M439.55 236.05 244 40.45a28.87 28.87 0 0 0-40.81 0l-40.66 40.63 51.52 51.52c27.06-9.14 52.68 16.77 43.39 43.68l49.66 49.66c34.23-11.8 61.18 31 35.47 56.69-26.49 26.49-70.21-2.87-56-37.34L240.22 199v121.85c25.3 12.54 22.26 41.85 9.08 55a34.34 34.34 0 0 1-48.55 0c-17.57-17.6-11.07-46.91 11.25-56v-123c-20.8-8.51-24.6-30.74-18.64-45L142.57 101 8.45 235.14a28.86 28.86 0 0 0 0 40.81l195.61 195.6a28.86 28.86 0 0 0 40.8 0l194.69-194.69a28.86 28.86 0 0 0 0-40.81z"/></svg>
  </div>
  <div class="md-source__repository">
    GitHub
  </div>
</a>
    </div>
  
  <ul class="md-nav__list" data-md-scrollfix>
    
      
      
      

  
  
  
    
    <li class="md-nav__item md-nav__item--nested">
      
      
        <input class="md-nav__toggle md-toggle" data-md-toggle="__nav_1" type="checkbox" id="__nav_1" >
      
      
      
      
        <label class="md-nav__link" for="__nav_1">
          Getting Started
          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <nav class="md-nav" aria-label="Getting Started" data-md-level="1">
        <label class="md-nav__title" for="__nav_1">
          <span class="md-nav__icon md-icon"></span>
          Getting Started
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../getting-started/" class="md-nav__link">
        Installation
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../configuration-file/" class="md-nav__link">
        Configuration
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../commands/" class="md-nav__link">
        Command Line Interface
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../running-kics/" class="md-nav__link">
        Running KICS
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../results/" class="md-nav__link">
        Results
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../platforms/" class="md-nav__link">
        Platforms
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../utilities/" class="md-nav__link">
        Utilities
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../architecture/" class="md-nav__link">
        Architecture
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../kics_auto_remediation/" class="md-nav__link">
        Auto Remediation
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../changes/" class="md-nav__link">
        Changes in v1.3.0
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../changes1_6/" class="md-nav__link">
        Changes in v1.6.0
      </a>
    </li>
  

            
          
        </ul>
      </nav>
    </li>
  

    
      
      
      

  
  
    
  
  
    
    <li class="md-nav__item md-nav__item--active md-nav__item--nested">
      
      
        <input class="md-nav__toggle md-toggle" data-md-toggle="__nav_2" type="checkbox" id="__nav_2" checked>
      
      
      
      
        <label class="md-nav__link" for="__nav_2">
          Queries
          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <nav class="md-nav" aria-label="Queries" data-md-level="1">
        <label class="md-nav__title" for="__nav_2">
          <span class="md-nav__icon md-icon"></span>
          Queries
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../queries/" class="md-nav__link">
        General Info
      </a>
    </li>
  

            
          
            
              
  
  
    
  
  
    <li class="md-nav__item md-nav__item--active">
      
      <input class="md-nav__toggle md-toggle" data-md-toggle="toc" type="checkbox" id="__toc">
      
      
      
        <label class="md-nav__link md-nav__link--active" for="__toc">
          Creating Queries
          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <a href="./" class="md-nav__link md-nav__link--active">
        Creating Queries
      </a>
      
        

<nav class="md-nav md-nav--secondary" aria-label="Table of contents">
  
  
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
      Table of contents
    </label>
    <ul class="md-nav__list" data-md-component="toc" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#create_a_new_query" class="md-nav__link">
    Create a new Query
  </a>
  
</li>
      
    </ul>
  
</nav>
      
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../secrets/" class="md-nav__link">
        Passwords And Secrets
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../bom/" class="md-nav__link">
        Bill of Materials
      </a>
    </li>
  

            
          
            
              
  
  
  
    
    <li class="md-nav__item md-nav__item--nested">
      
      
        <input class="md-nav__toggle md-toggle" data-md-toggle="__nav_2_5" type="checkbox" id="__nav_2_5" >
      
      
      
      
        <label class="md-nav__link" for="__nav_2_5">
          Queries List
          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <nav class="md-nav" aria-label="Queries List" data-md-level="2">
        <label class="md-nav__title" for="__nav_2_5">
          <span class="md-nav__icon md-icon"></span>
          Queries List
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../queries/all-queries/" class="md-nav__link">
        All
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../queries/common-queries/" class="md-nav__link">
        Common
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../queries/ansible-queries/" class="md-nav__link">
        Ansible
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../queries/azureresourcemanager-queries/" class="md-nav__link">
        Azure Resource Manager
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../queries/cloudformation-queries/" class="md-nav__link">
        CloudFormation
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../queries/dockerfile-queries/" class="md-nav__link">
        Dockerfile
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../queries/dockercompose-queries/" class="md-nav__link">
        Docker Compose
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../queries/kubernetes-queries/" class="md-nav__link">
        Kubernetes
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../queries/openapi-queries/" class="md-nav__link">
        OpenAPI
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../queries/googledeploymentmanager-queries/" class="md-nav__link">
        Google Deployment Manager
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../queries/grpc-queries/" class="md-nav__link">
        gRPC
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../queries/terraform-queries/" class="md-nav__link">
        Terraform
      </a>
    </li>
  

            
          
        </ul>
      </nav>
    </li>
  

            
          
        </ul>
      </nav>
    </li>
  

    
      
      
      

  
  
  
    
    <li class="md-nav__item md-nav__item--nested">
      
      
        <input class="md-nav__toggle md-toggle" data-md-toggle="__nav_3" type="checkbox" id="__nav_3" >
      
      
      
      
        <label class="md-nav__link" for="__nav_3">
          Integrations
          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <nav class="md-nav" aria-label="Integrations" data-md-level="1">
        <label class="md-nav__title" for="__nav_3">
          <span class="md-nav__icon md-icon"></span>
          Integrations
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../integrations/" class="md-nav__link">
        Overview
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../integrations_azurepipelines/" class="md-nav__link">
        Azure DevOps
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../integrations_bamboo/" class="md-nav__link">
        Bamboo
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../integrations_bitbucketpipelines/" class="md-nav__link">
        Bitbucket Pipelines
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../integrations_circleci/" class="md-nav__link">
        CircleCI
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../integrations_codefresh/" class="md-nav__link">
        Codefresh
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../integrations_ghactions/" class="md-nav__link">
        Github Actions
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../integrations_gitlabci/" class="md-nav__link">
        Gitlab CI
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../integrations_jenkins/" class="md-nav__link">
        Jenkins
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../integrations_teamcity/" class="md-nav__link">
        TeamCity
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../integrations_travisci/" class="md-nav__link">
        Travis CI
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../integrations_tfcloud/" class="md-nav__link">
        Terraform Cloud
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../integrations_aws_codebuild/" class="md-nav__link">
        AWS CodeBuild
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../BADGE/" class="md-nav__link">
        Badge
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../integrations_pre_commit/" class="md-nav__link">
        Using pre-commit hooks
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../integrations_terraformer/" class="md-nav__link">
        Terraformer
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../integrations_auto_scanning_visual_studio/" class="md-nav__link">
        KICS Auto Scanning
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../integrations_kuberneter/" class="md-nav__link">
        Kuberneter
      </a>
    </li>
  

            
          
        </ul>
      </nav>
    </li>
  

    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href="../certifications/" class="md-nav__link">
        Certifications
      </a>
    </li>
  

    
      
      
      

  
  
  
    
    <li class="md-nav__item md-nav__item--nested">
      
      
        <input class="md-nav__toggle md-toggle" data-md-toggle="__nav_5" type="checkbox" id="__nav_5" >
      
      
      
      
        <label class="md-nav__link" for="__nav_5">
          Project
          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <nav class="md-nav" aria-label="Project" data-md-level="1">
        <label class="md-nav__title" for="__nav_5">
          <span class="md-nav__icon md-icon"></span>
          Project
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../roadmap/" class="md-nav__link">
        Roadmap
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="https://github.com/Checkmarx/kics/projects" class="md-nav__link">
        Plans
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="https://github.com/Checkmarx/kics/issues" class="md-nav__link">
        Issues
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../releases/" class="md-nav__link">
        Releases
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../performance/" class="md-nav__link">
        Performance
      </a>
    </li>
  

            
          
        </ul>
      </nav>
    </li>
  

    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href="../CONTRIBUTING/" class="md-nav__link">
        Contribution
      </a>
    </li>
  

    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href="../community/" class="md-nav__link">
        Community
      </a>
    </li>
  

    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href="../about/" class="md-nav__link">
        About
      </a>
    </li>
  

    
  </ul>
</nav>
                  </div>
                </div>
              </div>
            
            
              
              <div class="md-sidebar md-sidebar--secondary" data-md-component="sidebar" data-md-type="toc" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    

<nav class="md-nav md-nav--secondary" aria-label="Table of contents">
  
  
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
      Table of contents
    </label>
    <ul class="md-nav__list" data-md-component="toc" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#create_a_new_query" class="md-nav__link">
    Create a new Query
  </a>
  
</li>
      
    </ul>
  
</nav>
                  </div>
                </div>
              </div>
            
          
          
            <div class="md-content" data-md-component="content">
              <article class="md-content__inner md-typeset">
                
                  

  <a href="https://github.com/Checkmarx/kics/edit/master/docs/creating-queries.md" title="Edit this page" class="md-content__button md-icon">
    
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20.71 7.04c.39-.39.39-1.04 0-1.41l-2.34-2.34c-.37-.39-1.02-.39-1.41 0l-1.84 1.83 3.75 3.75M3 17.25V21h3.75L17.81 9.93l-3.75-3.75L3 17.25Z"/></svg>
  </a>


  <h1>Creating Queries</h1>

<h2 id="create_a_new_query">Create a new Query<a class="headerlink" href="#create_a_new_query" title="Permanent link">&para;</a></h2>
<p>The queries are written in Rego and our internal parser transforms every IaC file that supports into a universal JSON format. This way anyone can start working on a query by picking up a small sample of the vulnerability that the query should target, and convert this sample, which can be a .tf or .yaml file, to our JSON structure JSON. To convert the sample you can run the following command:</p>
<pre><code class="language-bash">go run ./cmd/console/main.go scan -p &quot;pathToTestData&quot; -d &quot;pathToGenerateJson&quot;
</code></pre>
<p>So for example, if we wanted to transform a .tf file in ./code/test we could type:</p>
<pre><code class="language-bash">go run ./cmd/console/main.go scan -p  &quot;./src/test&quot; -d &quot;src/test/input.json&quot;
</code></pre>
<p>Example of input.json</p>
<pre><code class="language-json">{
    &quot;document&quot;: [
        {
            &quot;resource&quot;: {
                &quot;aws_cloudtrail&quot;: {
                    &quot;positive1&quot;: {
                        &quot;name&quot;: &quot;npositive_1&quot;,
                        &quot;s3_bucket_name&quot;: &quot;bucketlog_1&quot;
                    }
                }
            },
            &quot;id&quot;: &quot;02926636-f2c1-46c3-93cc-c7dc2a79791f&quot;,
            &quot;file&quot;: &quot;/assets/queries/terraform/aws/cloudtrail_multi_region_disabled/test/positive1.tf&quot;
        },
        {
            &quot;resource&quot;: {
                &quot;aws_cloudtrail&quot;: {
                    &quot;positive2&quot;: {
                        &quot;name&quot;: &quot;npositive_2&quot;,
                        &quot;s3_bucket_name&quot;: &quot;bucketlog_2&quot;,
                        &quot;is_multi_region_trail&quot;: false
                    }
                }
            },
            &quot;id&quot;: &quot;4b27da84-4d38-4422-b2b5-fa85029dad2a&quot;,
            &quot;file&quot;: &quot;assets/queries/terraform/aws/cloudtrail_multi_region_disabled/test/positive2.tf&quot;
        }
    ]
}
</code></pre>
<p>After having the .json that will be our Rego input, we can begin to write queries.
To test and debug there are two ways:</p>
<ul>
<li><a href="https://play.openpolicyagent.org/">Using Rego playground</a></li>
<li><a href="https://marketplace.visualstudio.com/items?itemName=tsandall.opa">Install Open Policy Agent extension</a> in VS Code and create a simple folder with a .rego file for the query and a input.json for the sample to test against</li>
</ul>
<h4 id="query_development_tutorial">Query Development Tutorial<a class="headerlink" href="#query_development_tutorial" title="Permanent link">&para;</a></h4>
<p>In the first instance, take a look at the query composition:
- <strong>query.rego</strong>: Includes the policy and defines the result. The policy builds the pattern that breaks the security of the infrastructure code, which the query is looking for. The result defines the specific data used to present the vulnerability in the infrastructure code.
- <strong>metadata.json</strong>: Each query has a metadata.json companion file with all the relevant information about the vulnerability, including the severity, category and its description;
- <strong>test</strong>: Folder that contains at least one negative and positive case and a JSON file with data about the expected results.</p>
<pre><code>- &lt;technology&gt;
    |- &lt;provider&gt;
    |   |- &lt;queryfolder&gt;
    |   |   |- test
    |   |   |   |- positive1&lt;.ext&gt;
    |   |   |   |- positive2&lt;.ext&gt;
    |   |   |   |- negative1&lt;.ext&gt;
    |   |   |   |- negative2&lt;.ext&gt;
    |   |   |   |- positive_expected_result.json
    |   |   |- metadata.json
    |   |   |- query.rego
</code></pre>
<p>Now, focus on the content of each file:</p>
<p>üë®‚Äçüíª <strong>REGO File</strong></p>
<p>As a first step, it is important to be familiar with the libraries available (check them in <code>assets/libraries</code>) and the JSON structure (Rego input). Also, we need to study all the possible cases related to the vulnerability we want to verify before starting the implementation.</p>
<p>For example, if we want to verify if the AWS CloudTrail has MultiRegion disabled in a Terraform sample, we need to focus on the attribute <code>is_multi_region_trail</code> of the resource <code>aws_cloudtrail</code>. Since this attribute is optional and false by default, we have two cases: (1) <code>is_multi_region_trail</code> is undefined and (2) <code>is_multi_region_trail</code> is set to false. Observe the following implementation as an example and check the Guidelines below.</p>
<p>:rotating_light: <strong>Make sure you use <code>package Cx</code>. If you give another name, the query will not load.</strong> :rotating_light:</p>
<pre><code>package Cx

CxPolicy[result] {
    cloudtrail := input.document[i].resource.aws_cloudtrail[name]
    object.get(cloudtrail, &quot;is_multi_region_trail&quot;, &quot;undefined&quot;) == &quot;undefined&quot;

    result := {
        &quot;documentId&quot;: input.document[i].id,
        &quot;searchKey&quot;: sprintf(&quot;aws_cloudtrail[%s]&quot;, [name]),
        &quot;issueType&quot;: &quot;MissingAttribute&quot;,
        &quot;keyExpectedValue&quot;: &quot;CloudTrail Multi Region is defined&quot;,
        &quot;keyActualValue&quot;: &quot;CloudTrail Multi Region is undefined&quot;,
    }
}

CxPolicy[result] {
    cloudtrail := input.document[i].resource.aws_cloudtrail[name]
    cloudtrail.is_multi_region_trail == false

    result := {
        &quot;documentId&quot;: input.document[i].id,
        &quot;searchKey&quot;: sprintf(&quot;aws_cloudtrail[%s].is_multi_region_trail&quot;, [name]),
        &quot;issueType&quot;: &quot;IncorrectValue&quot;,
        &quot;keyExpectedValue&quot;: &quot;CloudTrail Multi Region is set to true&quot;,
        &quot;keyActualValue&quot;: &quot;CloudTrail Multi Region is set to false&quot;,
    }
}
</code></pre>
<p>To test the query in the <a href="https://play.openpolicyagent.org/">Rego playground</a>, perform the following steps:
1. Enable Coverage (highlights which statements were evaluated);
2. In the input, paste the payload (explained above);
3. In the playground, paste and/or write the policies. Check if the statements are painted green;
4. Click on Evaluate;
5. In the output, check if the results are as expected.</p>
<p><img alt="RegoPlayground" src="img/rego_playground_example_tf.PNG"></p>
<p>üë®‚Äçüíª <strong>Metadata File</strong></p>
<p>Observe the following metadata.json example and check the Guidelines below for more detailed information.</p>
<pre><code class="language-json">{
  &quot;id&quot;: &quot;8173d5eb-96b5-4aa6-a71b-ecfa153c123d&quot;,
  &quot;queryName&quot;: &quot;CloudTrail Multi Region Disabled&quot;,
  &quot;severity&quot;: &quot;MEDIUM&quot;,
  &quot;category&quot;: &quot;Observability&quot;,
  &quot;descriptionText&quot;: &quot;CloudTrail should have 'is_multi_region_trail' and 'include_global_service_events' enabled&quot;,
  &quot;descriptionUrl&quot;: &quot;https://registry.terraform.io/providers/hashicorp/aws/latest/docs/resources/cloudtrail#is_multi_region_trail&quot;,
  &quot;platform&quot;: &quot;Terraform&quot;,
  &quot;descriptionID&quot;: &quot;feb82a62&quot;,
  &quot;cloudProvider&quot;: &quot;aws&quot;
}
</code></pre>
<p>üë®‚Äçüíª <strong>Data File</strong></p>
<p>This file contains a map, with string keys, which will have default values for keys that can be overwritten as described on <a href="#allowing-users-to-overwrite-query-data">allowing users to overwrite query data section</a> and <a href="../running-kics/#using-custom-input-data">using custom input data section of Running KICS</a></p>
<p>üë®‚Äçüíª <strong>Test Folder</strong></p>
<p>Keep in mind that all the positive and negative files should contain only one breaking point case. This way, the results are more clear. As a best practice, the test folder should contain all the <a href="https://docs.kics.io/latest/platforms/">extensions available</a> by the platform.</p>
<p>Each positive case should present a breaking point of the vulnerability. Continuing with the example, we should display two positive files: one without the <code>is_multi_region_trail</code> defined (positive1.tf) and another with the <code>is_multi_region_trail</code> set to false (positive2.tf).</p>
<p><em>positive1.tf</em></p>
<pre><code>resource &quot;aws_cloudtrail&quot; &quot;positive1&quot; {
  name                          = &quot;npositive_1&quot;
  s3_bucket_name                = &quot;bucketlog_1&quot;
}
</code></pre>
<p><em>positive2.tf</em></p>
<pre><code>resource &quot;aws_cloudtrail&quot; &quot;positive2&quot; {
  name                          = &quot;npositive_2&quot;
  s3_bucket_name                = &quot;bucketlog_2&quot;
  is_multi_region_trail         = false
}
</code></pre>
<p>Each negative case should present the remediation/best practice (a sample with the <code>is_multi_region_trail</code> set to true).</p>
<p><em>negative1.tf</em></p>
<pre><code>resource &quot;aws_cloudtrail&quot; &quot;negative1&quot; {
  name                          = &quot;negative&quot;
  s3_bucket_name                = &quot;bucketlog&quot;
  is_multi_region_trail         = true
}
</code></pre>
<p>The positive expected result should present where the positive(s) file(s) break(s) the vulnerability (in line 2 (positive1.tf) and line 4 (positive2.tf)).</p>
<pre><code class="language-json">[
  {
    &quot;queryName&quot;: &quot;CloudTrail Multi Region Disabled&quot;,
    &quot;severity&quot;: &quot;MEDIUM&quot;,
    &quot;line&quot;: 2,
    &quot;fileName&quot;: &quot;positive1.tf&quot;
  },
  {
    &quot;queryName&quot;: &quot;CloudTrail Multi Region Disabled&quot;,
    &quot;severity&quot;: &quot;MEDIUM&quot;,
    &quot;line&quot;: 4,
    &quot;fileName&quot;: &quot;positive2.tf&quot;
  }
]
</code></pre>
<h4 id="testing">Testing<a class="headerlink" href="#testing" title="Permanent link">&para;</a></h4>
<p>For a query to be considered complete, it must be compliant with at least one positive and one negative test case. To run the unit tests you can run this command:</p>
<pre><code class="language-bash">make test
</code></pre>
<p>Check if the new test was added correctly and if all tests are passing locally. If succeeds, a Pull Request can now be created.</p>
<h4 id="guidelines">Guidelines<a class="headerlink" href="#guidelines" title="Permanent link">&para;</a></h4>
<p>Filling metadata.json:</p>
<ul>
<li><code>id</code> should be filled with a UUID. You can use the built-in command to generate this:</li>
</ul>
<pre><code class="language-bash">go run ./cmd/console/main.go generate-id
</code></pre>
<ul>
<li><code>queryName</code> describes the name of the vulnerability</li>
<li><code>severity</code> can be filled with <code>HIGH</code>, <code>MEDIUM</code>, <code>LOW</code> or <code>INFO</code></li>
<li><code>category</code> pick one of the following:<ul>
<li>Access Control</li>
<li>Availability</li>
<li>Backup</li>
<li>Best Practices</li>
<li>Build Process</li>
<li>Encryption</li>
<li>Insecure Configurations</li>
<li>Insecure Defaults</li>
<li>Networking and Firewall</li>
<li>Observability</li>
<li>Resource Management</li>
<li>Secret Management</li>
<li>Supply-Chain</li>
</ul>
</li>
<li><code>descriptionText</code> should explain with detail the vulnerability and if possible provide a way to remediate</li>
<li><code>descriptionUrl</code> points to the official documentation about the resource being targeted</li>
<li><code>platform</code> query target platform (e.g. Terraform, Kubernetes, etc.)</li>
<li><code>descriptionID</code> should be filled with the first eight characters of the <code>go run ./cmd/console/main.go generate-id</code> output</li>
<li><code>cloudProvider</code> should specify the target cloud provider, when necessary (e.g. AWS, AZURE, GCP, etc.)</li>
<li><code>aggregation</code> [optional] should be used when more than one query is implemented in the same query.rego file. Indicates how many queries are implemented</li>
<li><code>override</code> [optional] should only be used when a <code>metadata.json</code> is shared between queries from different platforms or different specification versions like for example OpenAPI 2.0 (Swagger) and OpenAPI 3.0. This field defines an object that each field is mapped to a given <code>overrideKey</code> that should be provided from the query execution result (covered in the next section), if an <code>overrideKey</code> is provided, this will generate a new query that inherits the root level metadata values and only rewrites the fields defined inside this object.</li>
</ul>
<p>If the <strong>query.rego</strong> file implements more than one query, the <strong>metadata.json</strong> should indicate how many are implemented (through <code>aggregation</code>). That can be necessary due to two cases:
1. It implements more than one query in the same <strong>query.rego</strong> for the same platform</p>
<pre><code class="language-json">{
  &quot;id&quot;: &quot;0ac9abbc-6d7a-41cf-af23-2e57ddb3dbfc&quot;,
  &quot;queryName&quot;: &quot;Sensitive Port Is Exposed To Entire Network&quot;,
  &quot;severity&quot;: &quot;HIGH&quot;,
  &quot;category&quot;: &quot;Networking and Firewall&quot;,
  &quot;descriptionText&quot;: &quot;A sensitive port, such as port 23 or port 110, is open for the whole network in either TCP or UDP protocol&quot;,
  &quot;descriptionUrl&quot;: &quot;https://docs.ansible.com/ansible/latest/collections/azure/azcollection/azure_rm_securitygroup_module.html#parameter-rules&quot;,
  &quot;platform&quot;: &quot;Ansible&quot;,
  &quot;descriptionID&quot;: &quot;33745204&quot;,
  &quot;cloudProvider&quot;: &quot;azure&quot;,
  &quot;aggregation&quot;: 62
}
</code></pre>
<ol>
<li>It implements the same query for different platforms in the same <strong>query.rego</strong>, the metadata bellow defines the query metadata for both OpenAPI 2.0 and 3.0 in the same file:</li>
</ol>
<pre><code class="language-json">{
  &quot;id&quot;: &quot;332cf2ad-380d-4b90-b436-46f8e635cf38&quot;,
  &quot;queryName&quot;: &quot;Invalid Contact URL (v3)&quot;,
  &quot;severity&quot;: &quot;INFO&quot;,
  &quot;category&quot;: &quot;Best Practices&quot;,
  &quot;descriptionText&quot;: &quot;Contact Object URL should be a valid URL&quot;,
  &quot;descriptionUrl&quot;: &quot;https://swagger.io/specification/#contact-object&quot;,
  &quot;platform&quot;: &quot;OpenAPI&quot;,
  &quot;override&quot;: {
    &quot;2.0&quot;: {
      &quot;id&quot;: &quot;c7000383-16d0-4509-8cd3-585e5ea2e2f2&quot;,
      &quot;queryName&quot;: &quot;Invalid Contact URL (v2)&quot;,
      &quot;descriptionUrl&quot;: &quot;https://swagger.io/specification/v2/#contactObject&quot;
    }
  },
  &quot;aggregation&quot;: 2,
  &quot;descriptionID&quot;: &quot;f3097573&quot;
}
</code></pre>
<p>Filling query.rego:</p>
<ul>
<li><code>documentId</code> id of the sample where the vulnerability occurs</li>
<li>
<p><code>searchKey</code> uses Levenshtein distance to go through the original document. It should ‚Äúinclude‚Äù as much information as possible so that the result is as accurate as possible. </p>
<p>Note the following special chars:
- '='    -&gt; value
- '.'    -&gt; break line
- '{{ }}' -&gt; ignore special chars
- '[ ]'   -&gt; same line</p>
<p>As an example, take a look at the following sample:</p>
<p><img alt="image" src="https://user-images.githubusercontent.com/74001161/164218408-fd89bbc0-1bbc-40be-8d18-95b8216c9051.png" /></p>
<p>If we want to point to the field 'Name' set as 'My.bucket' of 'tags', the searchKey should be set to <code>resource[positive].tags.Name={{My.bucket}}</code></p>
</li>
<li>
<p><code>issueType</code> pick one of the following:</p>
<ul>
<li>IncorrectValue</li>
<li>MissingAttribute</li>
<li>RedundantAttribute</li>
</ul>
</li>
<li><code>keyExpectedValue</code> should explain the expected value</li>
<li><code>keyActualValue</code>   should explain the actual value detected</li>
<li><code>overrideKey</code> [optional] should be used when the query can be applied to more than one platform (for now, it is used for both OpenAPI 3.0 and Swagger)</li>
</ul>
<p>For example, the query <code>Invalid Contact URL</code> can be implemented in both OpenAPI 3.0 and Swagger since both versions share the same properties:</p>
<pre><code>package Cx

import data.generic.openapi as openapi_lib

CxPolicy[result] {
    doc := input.document[i]
    version := openapi_lib.check_openapi(doc)
    version != &quot;undefined&quot;

    not openapi_lib.is_valid_url(doc.info.contact.url)

    result := {
        &quot;documentId&quot;: doc.id,
        &quot;searchKey&quot;: &quot;info.contact.url&quot;,
        &quot;issueType&quot;: &quot;IncorrectValue&quot;,
        &quot;keyExpectedValue&quot;: &quot;info.contact.url has a valid URL&quot;,
        &quot;keyActualValue&quot;: &quot;info.contact.url has an invalid URL&quot;,
        &quot;overrideKey&quot;: version,
    }
}
</code></pre>
<ul>
<li><code>searchValue</code> [optional] should be used when the query returns more than one result for the same line</li>
<li><code>searchLine</code> [optional] path where the breaking point occurs in the sample</li>
</ul>
<p>For example, the query <strong>Sensitive Port Is Exposed To Entire Network</strong> can return more than one result in the same line (the ingress covers a range of ports). To avoid it, the <em>searchValue</em> should be used.</p>
<pre><code>package Cx

import data.generic.terraform as terraLib
import data.generic.common as commonLib

CxPolicy[result] {
    resource := input.document[i].resource.aws_security_group[name]

    portContent := commonLib.tcpPortsMap[port]
    portNumber = port
    portName = portContent
    protocol := terraLib.getProtocolList(resource.ingress.protocol)[_]

    endswith(resource.ingress.cidr_blocks[_], &quot;/0&quot;)
    terraLib.containsPort(resource.ingress, portNumber)
    isTCPorUDP(protocol)

    result := {
        &quot;documentId&quot;: input.document[i].id,
        &quot;searchKey&quot;: sprintf(&quot;aws_security_group[%s].ingress&quot;, [name]),
        &quot;searchValue&quot;: sprintf(&quot;%s,%d&quot;, [protocol, portNumber]),
        &quot;issueType&quot;: &quot;IncorrectValue&quot;,
        &quot;keyExpectedValue&quot;: sprintf(&quot;%s (%s:%d) should not be allowed&quot;, [portName, protocol, portNumber]),
        &quot;keyActualValue&quot;: sprintf(&quot;%s (%s:%d) is allowed&quot;, [portName, protocol, portNumber]),
    }
}

isTCPorUDP(&quot;TCP&quot;) = true
isTCPorUDP(&quot;UDP&quot;) = true
</code></pre>
<h4 id="search_line">Search Line<a class="headerlink" href="#search_line" title="Permanent link">&para;</a></h4>
<p>To improve the KICS line detection mechanism, <code>searchLine</code> was introduced.</p>
<p>SearchLine uses json path to get the correct line information from the payload (which can be seen with the flag <code>payload-lines</code>).</p>
<p>Original Content:</p>
<pre><code>father:
  name: son
</code></pre>
<p>Payload With Line Information:</p>
<pre><code>{
    &quot;_kics_lines&quot;: {
        &quot;_kics__default&quot;: {
            &quot;_kics_line&quot;: 0
        },
        &quot;_kics_father&quot;: {
            &quot;_kics_line&quot;: 2
        }
    },
    &quot;father&quot;: {
        &quot;_kics_lines&quot;: {
            &quot;_kics__default&quot;: {
                &quot;_kics_line&quot;: 2
            },
            &quot;_kics_name&quot;: {
                &quot;_kics_line&quot;: 3
            }
        },
        &quot;name&quot;: &quot;son&quot;
    }
},
</code></pre>
<p>Usage:</p>
<pre><code>import data.generic.common as commonLib

result := {
        &quot;documentId&quot;: doc.id,
        &quot;searchKey&quot;: &quot;father.son&quot;,
        &quot;issueType&quot;: &quot;IncorrectValue&quot;,
        &quot;searchLine&quot;: commonLib.build_search_line([&quot;father&quot;, &quot;son&quot;], []),
    }
</code></pre>
<p>Function <code>build_search_line(path, obj)</code>:</p>
<p>The function <code>build_search_line</code> is a helper that builds the searchLine for the engine to create and use the json path.
It take two arguments:</p>
<ul>
<li>
<p>path: An array containing the path elements (keys and indexes) to the desired key line.. (ex: ["father", "son"]; ["father", 1, "son"]; ["father", "son", 0])</p>
</li>
<li>
<p>obj: For queries that use the function <code>walk</code> in rego, where the caller is given a path that should be placed in the <code>path</code> argument of <code>build_search_line</code>, the remaining path not present should be placed in obj. Obj can also be used in other queries that don't make use of the function <code>walk</code>, otherwise it should be passed empty. (ex: ["son"],["son", 0])</p>
</li>
</ul>
<p>Examples:</p>
<pre><code>    build_search_line([&quot;father&quot;], [&quot;son&quot;])
</code></pre>
<pre><code>    build_search_line([&quot;father&quot;, &quot;son&quot;], [])
</code></pre>
<pre><code>    build_search_line([&quot;father&quot;, &quot;son&quot;], [&quot;grandson&quot;, 1])
</code></pre>
<pre><code>    [path, value] := walk(x)
    son := value.son
    son == false
    build_search_line(path, [&quot;son&quot;])
</code></pre>
<h4 id="allowing_users_to_overwrite_query_data">Allowing users to overwrite query data<a class="headerlink" href="#allowing_users_to_overwrite_query_data" title="Permanent link">&para;</a></h4>
<p>Starting on v1.3.5, KICS started to support custom data overwriting on queries. This can be useful if users want to provide their own dataset or if users have different datasets for multiple environments. This can be supported easily following some steps:</p>
<ol>
<li>Create a <code>data.json</code> file on the same level as <code>query.rego</code>;</li>
<li>Define <strong>ALL</strong> keys that can be overwritten with their default value;</li>
<li>On <code>query.rego</code> file, use <code>data.&lt;key_on_data_json_file&gt;</code> to access the value of this key;</li>
</ol>
<p>With these simple steps, users will be able to overwrite the keys they want, elsewhere will use the default value.</p>
<h4 id="query_dependencies">Query Dependencies<a class="headerlink" href="#query_dependencies" title="Permanent link">&para;</a></h4>
<p>If you want to use the functions defined in your own library, you should use the flag <code>-b</code> to indicate the directory where the libraries are placed. The functions need to be grouped by platform and the library name should follow the following format: <code>&lt;platform&gt;.rego</code>. It doesn't matter your directory structure. In other words, for example, if you want to indicate a directory that contains a library for your terraform queries, you should group your functions (used in your terraform queries) in a file named <code>terraform.rego</code> wherever you want.</p>





                
              </article>
            </div>
          
          
        </div>
        
      </main>
      
        <footer class="md-footer">
  
    
    <nav class="md-footer__inner md-grid" aria-label="Footer" >
      
        
        <a href="../queries/" class="md-footer__link md-footer__link--prev" aria-label="Previous: General Info" rel="prev">
          <div class="md-footer__button md-icon">
            <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11h12Z"/></svg>
          </div>
          <div class="md-footer__title">
            <div class="md-ellipsis">
              <span class="md-footer__direction">
                Previous
              </span>
              General Info
            </div>
          </div>
        </a>
      
      
        
        <a href="../secrets/" class="md-footer__link md-footer__link--next" aria-label="Next: Passwords And Secrets" rel="next">
          <div class="md-footer__title">
            <div class="md-ellipsis">
              <span class="md-footer__direction">
                Next
              </span>
              Passwords And Secrets
            </div>
          </div>
          <div class="md-footer__button md-icon">
            <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M4 11v2h12l-5.5 5.5 1.42 1.42L19.84 12l-7.92-7.92L10.5 5.5 16 11H4Z"/></svg>
          </div>
        </a>
      
    </nav>
  
  <div class="md-footer-meta md-typeset">
    <div class="md-footer-meta__inner md-grid">
      <div class="md-copyright">
  
    <div class="md-copyright__highlight">
      &copy; 2021 Checkmarx Ltd. All Rights Reserved.
    </div>
  
  
    Made with
    <a href="https://squidfunk.github.io/mkdocs-material/" target="_blank" rel="noopener">
      Material for MkDocs
    </a>
  
</div>
      
    </div>
  </div>
</footer>
      
    </div>
    <div class="md-dialog" data-md-component="dialog">
      <div class="md-dialog__inner md-typeset"></div>
    </div>
    
    <script id="__config" type="application/json">{"base": "..", "features": ["navigation.tabs", "navigation.tabs.sticky"], "search": "../assets/javascripts/workers/search.16e2a7d4.min.js", "translations": {"clipboard.copied": "Copied to clipboard", "clipboard.copy": "Copy to clipboard", "search.config.lang": "en", "search.config.pipeline": "trimmer, stopWordFilter", "search.config.separator": "[\\s\\-]+", "search.placeholder": "Search", "search.result.more.one": "1 more on this page", "search.result.more.other": "# more on this page", "search.result.none": "No matching documents", "search.result.one": "1 matching document", "search.result.other": "# matching documents", "search.result.placeholder": "Type to start searching", "search.result.term.missing": "Missing", "select.version.title": "Select version"}, "version": {"provider": "mike"}}</script>
    
    
      <script src="../assets/javascripts/bundle.8492ddcf.min.js"></script>
      
        <script src="../js/version-mike.js"></script>
      
        <script src="../js/custom.js"></script>
      
    
  </body>
</html>