{
	"kics_version": "development",
	"files_scanned": 1,
	"lines_scanned": 289,
	"files_parsed": 1,
	"lines_parsed": 282,
	"files_failed_to_scan": 0,
	"queries_total": 13,
	"queries_failed_to_execute": 0,
	"queries_failed_to_compute_similarity_id": 0,
	"scan_id": "console",
	"severity_counters": {
		"HIGH": 6,
		"INFO": 3,
		"LOW": 1,
		"MEDIUM": 9,
		"TRACE": 0
	},
	"total_counter": 19,
	"total_bom_resources": 0,
	"start": "2023-06-07T16:57:39.9988547+01:00",
	"end": "2023-06-07T16:57:42.1409286+01:00",
	"paths": [
		"path/e2e/fixtures/samples/positive.yaml"
	],
	"queries": [
		{
			"query_name": "ALB Listening on HTTP",
			"query_id": "275a3217-ca37-40c1-a6cf-bb57d245ab32",
			"query_url": "https://docs.aws.amazon.com/AWSCloudFormation/latest/UserGuide/aws-properties-ec2-elb-listener.html#cfn-ec2-elb-listener-protocol",
			"severity": "HIGH",
			"platform": "CloudFormation",
			"cloud_provider": "AWS",
			"category": "Networking and Firewall",
			"description": "AWS Application Load Balancer (alb) should not listen on HTTP",
			"description_id": "55f05412",
			"files": [
				{
					"file_name": "\\path\\e2e\\fixtures\\samples\\positive.yaml\\positive.yaml",
					"similarity_id": "2fb08925c31f58f1d35206dc2ca59d344355d89974a296e7e8573d80d9d671ae",
					"line": 104,
					"resource_type": "AWS::ElasticLoadBalancingV2::Listener",
					"resource_name": "ALBListener",
					"issue_type": "IncorrectValue",
					"search_key": "Resources.ALBListener.Properties.Protocol=HTTP",
					"search_line": 0,
					"search_value": "",
					"expected_value": "'Resources.ALBListener.Protocol' should not equal to 'HTTP'",
					"actual_value": "'Resources.ALBListener.Protocol' equals to 'HTTP'"
				}
			]
		},
		{
			"query_name": "ECS Task Definition Network Mode Not Recommended",
			"query_id": "027a4b7a-8a59-4938-a04f-ed532512cf45",
			"query_url": "https://docs.aws.amazon.com/AWSCloudFormation/latest/UserGuide/aws-resource-ecs-taskdefinition.html#cfn-ecs-taskdefinition-networkmode",
			"severity": "HIGH",
			"platform": "CloudFormation",
			"cloud_provider": "AWS",
			"category": "Insecure Configurations",
			"description": "Network_Mode should be 'awsvpc' in ecs_task_definition. AWS VPCs provides the controls to facilitate a formal process for approving and testing all network connections and changes to the firewall and router configurations",
			"description_id": "bded2e99",
			"files": [
				{
					"file_name": "\\path\\e2e\\fixtures\\samples\\positive.yaml\\positive.yaml",
					"similarity_id": "460b2063ff7913a607f3b970426ceb4f8461a4342899746cd1ec861c748b4af0",
					"line": 48,
					"resource_type": "AWS::ECS::TaskDefinition",
					"resource_name": "TaskDefinition",
					"issue_type": "MissingAttribute",
					"search_key": "Resources.TaskDefinition.Properties",
					"search_line": 0,
					"search_value": "",
					"expected_value": "'Resources.TaskDefinition.Properties.NetworkMode' should be set and should be 'awsvpc'",
					"actual_value": "'Resources.TaskDefinition.Properties.NetworkMode' is undefined and defaults to 'bridge'"
				}
			]
		},
		{
			"query_name": "Fully Open Ingress",
			"query_id": "e415f8d3-fc2b-4f52-88ab-1129e8c8d3f5",
			"query_url": "https://docs.aws.amazon.com/AmazonECS/latest/developerguide/get-set-up-for-amazon-ecs.html#create-a-base-security-group",
			"severity": "HIGH",
			"platform": "CloudFormation",
			"cloud_provider": "AWS",
			"category": "Networking and Firewall",
			"description": "ECS Service's security group should not allow unrestricted access to all ports from all IPv4 addresses",
			"description_id": "747f49ac",
			"files": [
				{
					"file_name": "\\path\\e2e\\fixtures\\samples\\positive.yaml\\positive.yaml",
					"similarity_id": "0ffaad1f3c48da88fb136d442e6162823c4ece9583b8f4e67f0469def53cb649",
					"line": 24,
					"resource_type": "AWS::EC2::SecurityGroupIngress",
					"resource_name": "EcsSecurityGroupHTTPinbound02",
					"issue_type": "IncorrectValue",
					"search_key": "Resources.EcsSecurityGroupHTTPinbound02.Properties.CidrIp",
					"search_line": 0,
					"search_value": "",
					"expected_value": "Resource name 'EcsSecurityGroupHTTPinbound02' of type 'AWS::EC2::SecurityGroupIngress' should not accept ingress connections from all IPv4 adresses and to all available ports",
					"actual_value": "Resource name 'EcsSecurityGroupHTTPinbound02' of type 'AWS::EC2::SecurityGroupIngress' should not accept ingress connections from CIDR 0.0.0.0/0 to all available ports"
				},
				{
					"file_name": "\\path\\e2e\\fixtures\\samples\\positive.yaml\\positive.yaml",
					"similarity_id": "8f5c504ffbcc5bff5305ffdc273de774daaaa0af94927d1aaf6ee471ebaf07a8",
					"line": 32,
					"resource_type": "AWS::EC2::SecurityGroupIngress",
					"resource_name": "EcsSecurityGroupSSHinbound",
					"issue_type": "IncorrectValue",
					"search_key": "Resources.EcsSecurityGroupSSHinbound.Properties.CidrIp",
					"search_line": 0,
					"search_value": "",
					"expected_value": "Resource name 'EcsSecurityGroupSSHinbound' of type 'AWS::EC2::SecurityGroupIngress' should not accept ingress connections from all IPv4 adresses and to all available ports",
					"actual_value": "Resource name 'EcsSecurityGroupSSHinbound' of type 'AWS::EC2::SecurityGroupIngress' should not accept ingress connections from CIDR 0.0.0.0/0 to all available ports"
				}
			]
		},
		{
			"query_name": "Unrestricted Security Group Ingress",
			"query_id": "4a1e6b34-1008-4e61-a5f2-1f7c276f8d14",
			"query_url": "https://docs.aws.amazon.com/AWSCloudFormation/latest/UserGuide/aws-properties-ec2-security-group-ingress.html",
			"severity": "HIGH",
			"platform": "CloudFormation",
			"cloud_provider": "AWS",
			"category": "Networking and Firewall",
			"description": "AWS Security Group Ingress CIDR should not be open to the world",
			"description_id": "08256d31",
			"files": [
				{
					"file_name": "\\path\\e2e\\fixtures\\samples\\positive.yaml\\positive.yaml",
					"similarity_id": "e683e183ceb515c599aac7ea22326ee827cf64fdb7cae5f9d5f37f9763b72a6a",
					"line": 32,
					"resource_type": "AWS::EC2::SecurityGroupIngress",
					"resource_name": "EcsSecurityGroupSSHinbound",
					"issue_type": "IncorrectValue",
					"search_key": "Resources.EcsSecurityGroupSSHinbound.Properties.CidrIp",
					"search_line": 0,
					"search_value": "",
					"expected_value": "Resources.EcsSecurityGroupSSHinbound.Properties.CidrIp should not be open to the world (0.0.0.0/0)",
					"actual_value": "Resources.EcsSecurityGroupSSHinbound.Properties.CidrIp is open to the world (0.0.0.0/0)"
				},
				{
					"file_name": "\\path\\e2e\\fixtures\\samples\\positive.yaml\\positive.yaml",
					"similarity_id": "f5617c5ade65969bd3659354039a859d77f6bbd1191313a37d0a73d817dfdeb0",
					"line": 24,
					"resource_type": "AWS::EC2::SecurityGroupIngress",
					"resource_name": "EcsSecurityGroupHTTPinbound02",
					"issue_type": "IncorrectValue",
					"search_key": "Resources.EcsSecurityGroupHTTPinbound02.Properties.CidrIp",
					"search_line": 0,
					"search_value": "",
					"expected_value": "Resources.EcsSecurityGroupHTTPinbound02.Properties.CidrIp should not be open to the world (0.0.0.0/0)",
					"actual_value": "Resources.EcsSecurityGroupHTTPinbound02.Properties.CidrIp is open to the world (0.0.0.0/0)"
				}
			]
		},
		{
			"query_name": "ALB Is Not Integrated With WAF",
			"query_id": "105ba098-1e34-48cd-b0f2-a8a43a51bf9b",
			"query_url": "https://docs.aws.amazon.com/AWSCloudFormation/latest/UserGuide/aws-resource-wafregional-webaclassociation.html",
			"severity": "MEDIUM",
			"platform": "CloudFormation",
			"cloud_provider": "AWS",
			"category": "Networking and Firewall",
			"description": "All Application Load Balancers (ALB) must be protected with Web Application Firewall (WAF) service",
			"description_id": "2cad71a7",
			"files": [
				{
					"file_name": "\\path\\e2e\\fixtures\\samples\\positive.yaml\\positive.yaml",
					"similarity_id": "082b56085122729f8eefd988572900a0978044d734c947dcd968543e4275db9c",
					"line": 86,
					"resource_type": "AWS::ElasticLoadBalancingV2::LoadBalancer",
					"resource_name": "ECSALB",
					"issue_type": "MissingAttribute",
					"search_key": "Resources.ECSALB",
					"search_line": 0,
					"search_value": "",
					"expected_value": "'Resources.ECSALB' should not have an 'internal' scheme and should have a 'WebACLAssociation' associated",
					"actual_value": "'Resources.ECSALB' does not have an 'internal' scheme and a 'WebACLAssociation' associated"
				}
			]
		},
		{
			"query_name": "Auto Scaling Group With No Associated ELB",
			"query_id": "ad21e616-5026-4b9d-990d-5b007bfe679c",
			"query_url": "https://docs.aws.amazon.com/AWSCloudFormation/latest/UserGuide/aws-properties-as-group.html",
			"severity": "MEDIUM",
			"platform": "CloudFormation",
			"cloud_provider": "AWS",
			"category": "Availability",
			"description": "AWS Auto Scaling Groups must have associated ELBs to ensure high availability and improve application performance. This means the attribute 'LoadBalancerNames' must be defined and not empty.",
			"description_id": "99966f58",
			"files": [
				{
					"file_name": "\\path\\e2e\\fixtures\\samples\\positive.yaml\\positive.yaml",
					"similarity_id": "e53a331cc72b2a733373d27fb2ba42295ce29085e177855fda17166d04e4a062",
					"line": 131,
					"resource_type": "AWS::AutoScaling::AutoScalingGroup",
					"resource_name": "ECSAutoScalingGroup",
					"issue_type": "MissingAttribute",
					"search_key": "Resources.ECSAutoScalingGroup.Properties",
					"search_line": 0,
					"search_value": "",
					"expected_value": "'Resources.ECSAutoScalingGroup.Properties.LoadBalancerNames' should be defined",
					"actual_value": "'Resources.ECSAutoScalingGroup.Properties.LoadBalancerNames' is not defined"
				}
			]
		},
		{
			"query_name": "ECS Service Without Running Tasks",
			"query_id": "79d745f0-d5f3-46db-9504-bef73e9fd528",
			"query_url": "https://docs.aws.amazon.com/AWSCloudFormation/latest/UserGuide/aws-resource-ecs-service.html#cfn-ecs-service-deploymentconfiguration",
			"severity": "MEDIUM",
			"platform": "CloudFormation",
			"cloud_provider": "AWS",
			"category": "Availability",
			"description": "ECS Service should have at least 1 task running",
			"description_id": "cd242bdd",
			"files": [
				{
					"file_name": "\\path\\e2e\\fixtures\\samples\\positive.yaml\\positive.yaml",
					"similarity_id": "d4696bb82fc5e0652bf1aacfc622b421919fe924895fa18c9a61066058f19032",
					"line": 159,
					"resource_type": "AWS::ECS::Service",
					"resource_name": "service",
					"issue_type": "MissingAttribute",
					"search_key": "Resources.service.Properties",
					"search_line": 0,
					"search_value": "",
					"expected_value": "Resources.service.Properties.DeploymentConfiguration should be defined and not null",
					"actual_value": "Resources.service.Properties.DeploymentConfiguration is undefined or null"
				}
			]
		},
		{
			"query_name": "ELB With Security Group Without Inbound Rules",
			"query_id": "e200a6f3-c589-49ec-9143-7421d4a2c845",
			"query_url": "https://docs.aws.amazon.com/AWSCloudFormation/latest/UserGuide/aws-properties-ec2-security-group.html#cfn-ec2-securitygroup-securitygroupingress",
			"severity": "MEDIUM",
			"platform": "CloudFormation",
			"cloud_provider": "AWS",
			"category": "Networking and Firewall",
			"description": "An AWS Elastic Load Balancer (ELB) shouldn´t have security groups without outbound rules",
			"description_id": "3ccdd7d2",
			"files": [
				{
					"file_name": "\\path\\e2e\\fixtures\\samples\\positive.yaml\\positive.yaml",
					"similarity_id": "cd0aa686f1a363eb1de100e810d81d6f7234dbeb0153bce5148572bf3d8e4013",
					"line": 14,
					"resource_type": "AWS::ElasticLoadBalancingV2::LoadBalancer",
					"resource_name": "ECSALB",
					"issue_type": "MissingAttribute",
					"search_key": "Resources.EcsSecurityGroup.Properties",
					"search_line": 0,
					"search_value": "",
					"expected_value": "'Resources.EcsSecurityGroup.Properties.SecurityGroupIngress' is defined",
					"actual_value": "'Resources.EcsSecurityGroup.Properties.SecurityGroupIngress' is undefined"
				}
			]
		},
		{
			"query_name": "ELB With Security Group Without Outbound Rules",
			"query_id": "01d5a458-a6c4-452a-ac50-054d59275b7c",
			"query_url": "https://docs.aws.amazon.com/AWSCloudFormation/latest/UserGuide/aws-properties-ec2-security-group.html#cfn-ec2-securitygroup-securitygroupegress",
			"severity": "MEDIUM",
			"platform": "CloudFormation",
			"cloud_provider": "AWS",
			"category": "Networking and Firewall",
			"description": "An AWS Elastic Load Balancer (ELB) shouldn´t have security groups without outbound rules",
			"description_id": "7b876844",
			"files": [
				{
					"file_name": "\\path\\e2e\\fixtures\\samples\\positive.yaml\\positive.yaml",
					"similarity_id": "8a13b3813e45997546157feae0ee67ad72d7628269742e99f857bde1f3c608ae",
					"line": 14,
					"resource_type": "AWS::ElasticLoadBalancingV2::LoadBalancer",
					"resource_name": "ECSALB",
					"issue_type": "MissingAttribute",
					"search_key": "Resources.EcsSecurityGroup.Properties",
					"search_line": 0,
					"search_value": "",
					"expected_value": "'Resources.EcsSecurityGroup.Properties.SecurityGroupEgress' is defined",
					"actual_value": "'Resources.EcsSecurityGroup.Properties.SecurityGroupEgress' is undefined"
				}
			]
		},
		{
			"query_name": "Empty Roles For ECS Cluster Task Definitions",
			"query_id": "7f384a5f-b5a2-4d84-8ca3-ee0a5247becb",
			"query_url": "https://docs.aws.amazon.com/AWSCloudFormation/latest/UserGuide/aws-resource-ecs-service.html",
			"severity": "MEDIUM",
			"platform": "CloudFormation",
			"cloud_provider": "AWS",
			"category": "Access Control",
			"description": "Check if any ECS cluster has not defined proper roles for services' task definitions.",
			"description_id": "b47b42b2",
			"files": [
				{
					"file_name": "\\path\\e2e\\fixtures\\samples\\positive.yaml\\positive.yaml",
					"similarity_id": "b591f30776e35beb7ec98a0237ef699c1331ab204d9d067994dec46171479317",
					"line": 167,
					"resource_type": "AWS::ECS::Service",
					"resource_name": "service",
					"issue_type": "IncorrectValue",
					"search_key": "Resources.service.Properties.TaskDefinition",
					"search_line": 0,
					"search_value": "",
					"expected_value": "'Resources.service.Properties.TaskDefinition' refers to a TaskDefinition with Role",
					"actual_value": "'Resources.service.Properties.TaskDefinition' does not refer to a TaskDefinition with Role"
				}
			]
		},
		{
			"query_name": "Security Group Ingress With Port Range",
			"query_id": "87482183-a8e7-4e42-a566-7a23ec231c16",
			"query_url": "https://docs.aws.amazon.com/AWSCloudFormation/latest/UserGuide/aws-properties-ec2-security-group-ingress.html",
			"severity": "MEDIUM",
			"platform": "CloudFormation",
			"cloud_provider": "AWS",
			"category": "Networking and Firewall",
			"description": "AWS Security Group Ingress should have a single port",
			"description_id": "5f2b65f3",
			"files": [
				{
					"file_name": "\\path\\e2e\\fixtures\\samples\\positive.yaml\\positive.yaml",
					"similarity_id": "9485f56abd2b0ed60a494a8e553300fc187692990313d78359456a4988454dbd",
					"line": 19,
					"resource_type": "AWS::EC2::SecurityGroupIngress",
					"resource_name": "EcsSecurityGroupHTTPinbound02",
					"issue_type": "IncorrectValue",
					"search_key": "Resources.EcsSecurityGroupHTTPinbound02.Properties",
					"search_line": 0,
					"search_value": "",
					"expected_value": "Resources.EcsSecurityGroupHTTPinbound02.Properties.FromPort should equal to Resources.EcsSecurityGroupHTTPinbound02.Properties.ToPort",
					"actual_value": "Resources.EcsSecurityGroupHTTPinbound02.Properties.FromPort is not equal to Resources.EcsSecurityGroupHTTPinbound02.Properties.ToPort"
				},
				{
					"file_name": "\\path\\e2e\\fixtures\\samples\\positive.yaml\\positive.yaml",
					"similarity_id": "eccd5525f81a3f29e866e1733212c9d94b062d1bb8463b1aba7085827ae410a3",
					"line": 27,
					"resource_type": "AWS::EC2::SecurityGroupIngress",
					"resource_name": "EcsSecurityGroupSSHinbound",
					"issue_type": "IncorrectValue",
					"search_key": "Resources.EcsSecurityGroupSSHinbound.Properties",
					"search_line": 0,
					"search_value": "",
					"expected_value": "Resources.EcsSecurityGroupSSHinbound.Properties.FromPort should equal to Resources.EcsSecurityGroupSSHinbound.Properties.ToPort",
					"actual_value": "Resources.EcsSecurityGroupSSHinbound.Properties.FromPort is not equal to Resources.EcsSecurityGroupSSHinbound.Properties.ToPort"
				},
				{
					"file_name": "\\path\\e2e\\fixtures\\samples\\positive.yaml\\positive.yaml",
					"similarity_id": "092b7af7916adbea86a8856ac4a1b879ab6fc0ae7cea57752b02d1d0dff3ede6",
					"line": 35,
					"resource_type": "AWS::EC2::SecurityGroupIngress",
					"resource_name": "EcsSecurityGroupALBports",
					"issue_type": "IncorrectValue",
					"search_key": "Resources.EcsSecurityGroupALBports.Properties",
					"search_line": 0,
					"search_value": "",
					"expected_value": "Resources.EcsSecurityGroupALBports.Properties.FromPort should equal to Resources.EcsSecurityGroupALBports.Properties.ToPort",
					"actual_value": "Resources.EcsSecurityGroupALBports.Properties.FromPort is not equal to Resources.EcsSecurityGroupALBports.Properties.ToPort"
				}
			]
		},
		{
			"query_name": "ECS Task Definition HealthCheck Missing",
			"query_id": "d24389b4-b209-4ff0-8345-dc7a4569dcdd",
			"query_url": "https://docs.aws.amazon.com/AWSCloudFormation/latest/UserGuide/aws-properties-ecs-taskdefinition-healthcheck.html",
			"severity": "LOW",
			"platform": "CloudFormation",
			"cloud_provider": "AWS",
			"category": "Observability",
			"description": "Amazon ECS must have the HealthCheck property defined to give more control over monitoring the health of tasks",
			"description_id": "e2e3a50a",
			"files": [
				{
					"file_name": "\\path\\e2e\\fixtures\\samples\\positive.yaml\\positive.yaml",
					"similarity_id": "f12110e107044e4b8a90e249b1383359c71126d63a6c8c58aefac323b2320e16",
					"line": 50,
					"resource_type": "AWS::ECS::TaskDefinition",
					"resource_name": "TaskDefinition",
					"issue_type": "MissingAttribute",
					"search_key": "Resources.TaskDefinition.Properties.ContainerDefinitions",
					"search_line": 0,
					"search_value": "",
					"expected_value": "'Resources.TaskDefinition.Properties.ContainerDefinitions' should contain 'HealthCheck' property",
					"actual_value": "'Resources.TaskDefinition.Properties.ContainerDefinitions' doesn't contain 'HealthCheck' property"
				}
			]
		},
		{
			"query_name": "Security Group Rule Without Description",
			"query_id": "5e6c9c68-8a82-408e-8749-ddad78cbb9c5",
			"query_url": "https://docs.aws.amazon.com/AWSCloudFormation/latest/UserGuide/aws-properties-ec2-security-group.html",
			"severity": "INFO",
			"platform": "CloudFormation",
			"cloud_provider": "AWS",
			"category": "Best Practices",
			"description": "It's considered a best practice for AWS Security Group to have a description",
			"description_id": "f7c62b11",
			"files": [
				{
					"file_name": "\\path\\e2e\\fixtures\\samples\\positive.yaml\\positive.yaml",
					"similarity_id": "782d15b0896da7a8c760669a74e1279466dc22aa377a93ad9f20ab69a5878315",
					"line": 27,
					"resource_type": "AWS::EC2::SecurityGroupIngress",
					"resource_name": "EcsSecurityGroupSSHinbound",
					"issue_type": "MissingAttribute",
					"search_key": "Resources.EcsSecurityGroupSSHinbound.Properties",
					"search_line": 0,
					"search_value": "",
					"expected_value": "Resources.EcsSecurityGroupSSHinbound.Properties.Description should be set",
					"actual_value": "Resources.EcsSecurityGroupSSHinbound.Properties.Description is undefined"
				},
				{
					"file_name": "\\path\\e2e\\fixtures\\samples\\positive.yaml\\positive.yaml",
					"similarity_id": "e3a9cb3508500b88a438cf866b5c272834bb7bc5f73399b574c214ad84355128",
					"line": 35,
					"resource_type": "AWS::EC2::SecurityGroupIngress",
					"resource_name": "EcsSecurityGroupALBports",
					"issue_type": "MissingAttribute",
					"search_key": "Resources.EcsSecurityGroupALBports.Properties",
					"search_line": 0,
					"search_value": "",
					"expected_value": "Resources.EcsSecurityGroupALBports.Properties.Description should be set",
					"actual_value": "Resources.EcsSecurityGroupALBports.Properties.Description is undefined"
				},
				{
					"file_name": "\\path\\e2e\\fixtures\\samples\\positive.yaml\\positive.yaml",
					"similarity_id": "3ad7df487c358250092fee5b553a76e97d83b15a284e23b4e3630bb90ed05507",
					"line": 19,
					"resource_type": "AWS::EC2::SecurityGroupIngress",
					"resource_name": "EcsSecurityGroupHTTPinbound02",
					"issue_type": "MissingAttribute",
					"search_key": "Resources.EcsSecurityGroupHTTPinbound02.Properties",
					"search_line": 0,
					"search_value": "",
					"expected_value": "Resources.EcsSecurityGroupHTTPinbound02.Properties.Description should be set",
					"actual_value": "Resources.EcsSecurityGroupHTTPinbound02.Properties.Description is undefined"
				}
			]
		}
	]
}
