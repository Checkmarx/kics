{
  "kics_version": "development",
  "files_scanned": 2,
  "lines_scanned": 54,
  "files_parsed": 2,
  "lines_parsed": 53,
  "lines_ignored": 1,
  "files_failed_to_scan": 0,
  "queries_total": 2,
  "queries_failed_to_execute": 0,
  "queries_failed_to_compute_similarity_id": 0,
  "scan_id": "console",
  "severity_counters": {
    "CRITICAL": 0,
    "HIGH": 0,
    "INFO": 0,
    "LOW": 9,
    "MEDIUM": 3,
    "TRACE": 0
  },
  "total_counter": 12,
  "total_bom_resources": 0,
  "start": "2025-10-08T17:23:23.074521+01:00",
  "end": "2025-10-08T17:23:26.7848028+01:00",
  "paths": [
    "/path/test/fixtures/new_similarity_id"
  ],
  "queries": [
    {
      "query_name": "Container Running As Root",
      "query_id": "cf34805e-3872-4c08-bf92-6ff7bb0cfadb",
      "query_url": "https://kubernetes.io/docs/tasks/configure-pod-container/security-context/",
      "severity": "MEDIUM",
      "platform": "Kubernetes",
      "cwe": "1188",
      "risk_score": "5.8",
      "cloud_provider": "COMMON",
      "category": "Best Practices",
      "experimental": false,
      "description": "Containers should only run as non-root user. This limits the exploitability of security misconfigurations and restricts an attacker's possibilities in case of compromise",
      "description_id": "9d5b1d16",
      "files": [
        {
          "file_name": "path\\test\\fixtures\\new_similarity_id\\containers_running_as_root.yaml",
          "similarity_id": "72f7ed9fcf3a36c3e16d8f0a058bf3035710ce4a379b39eed7bffdc90ba94c4e",
          "old_similarity_id": "fe3529db8e23da14395120acb3cff1df4592c1e8c4ac24a908ba9072a1810399",
          "line": 28,
          "resource_type": "Pod",
          "resource_name": "security-context-demo-3",
          "issue_type": "IncorrectValue",
          "search_key": "metadata.name={{security-context-demo-3}}.spec.containers.name={{sec-ctx-demo-2}}.securityContext.runAsUser",
          "search_line": 28,
          "search_value": "Pod",
          "expected_value": "metadata.name={{security-context-demo-3}}.spec.containers.name={{sec-ctx-demo-2}}.securityContext runAsUser is higher than 0 and/or 'runAsNonRoot' is true",
          "actual_value": "metadata.name={{security-context-demo-3}}.spec.containers.name={{sec-ctx-demo-2}}.securityContext runAsUser is 0 and 'runAsNonRoot' is false"
        },
        {
          "file_name": "path\\test\\fixtures\\new_similarity_id\\containers_running_as_root.yaml",
          "similarity_id": "a87875af79b8c0687c761fbb0ef71e8c81041948176cff4f189d4e2681ead84d",
          "old_similarity_id": "e306521ba1e4ab1977b138dfacc112ef692f5b578786a149d86094582063b88f",
          "line": 12,
          "resource_type": "Pod",
          "resource_name": "security-context-demo-2",
          "issue_type": "IncorrectValue",
          "search_key": "metadata.name={{security-context-demo-2}}.spec.containers.name={{sec-ctx-demo-2}}.securityContext.runAsUser",
          "search_line": 12,
          "search_value": "Pod",
          "expected_value": "metadata.name={{security-context-demo-2}}.spec.containers.name={{sec-ctx-demo-2}}.securityContext runAsUser is higher than 0 and/or 'runAsNonRoot' is true",
          "actual_value": "metadata.name={{security-context-demo-2}}.spec.containers.name={{sec-ctx-demo-2}}.securityContext runAsUser is 0 and 'runAsNonRoot' is false"
        },
        {
          "file_name": "path\\test\\fixtures\\new_similarity_id\\containers_running_as_root.yaml",
          "similarity_id": "89153c25e998f1e4699d926ed8323217424911d630b610cded7b5b7ff601593e",
          "old_similarity_id": "5cfb1b1a3c0cb3816c82f259d67bd99276ee00f2fcbe5c0582e9cbf93b6a9523",
          "line": 43,
          "resource_type": "Pod",
          "resource_name": "security-context-demo-4",
          "issue_type": "IncorrectValue",
          "search_key": "metadata.name={{security-context-demo-4}}.spec.containers.name={{sec-ctx-demo-2}}.securityContext.runAsUser",
          "search_line": 43,
          "search_value": "Pod",
          "expected_value": "metadata.name={{security-context-demo-4}}.spec.containers.name={{sec-ctx-demo-2}}.securityContext runAsUser is higher than 0 and/or 'runAsNonRoot' is true",
          "actual_value": "metadata.name={{security-context-demo-4}}.spec.containers.name={{sec-ctx-demo-2}}.securityContext runAsUser is 0 and 'runAsNonRoot' is false"
        }
      ]
    },
    {
      "query_name": "Audit Policy Not Cover Key Security Concerns",
      "query_id": "1828a670-5957-4bc5-9974-47da228f75e2",
      "query_url": "https://kubernetes.io/docs/tasks/debug-application-cluster/audit/",
      "severity": "LOW",
      "platform": "Kubernetes",
      "cwe": "532",
      "risk_score": "3.3",
      "cloud_provider": "COMMON",
      "category": "Observability",
      "experimental": false,
      "description": "Audit Policy should cover key security concerns about the sensitive data logged in Kubernetes audit policies",
      "description_id": "4a720a0c",
      "files": [
        {
          "file_name": "path\\fixtures\\new_similarity_id\\audit_policy_not_cover_key_security_concerns.yaml",
          "similarity_id": "aa44987d9d73d38a61d3790b4e5e740dab278091749ff889ae1d5d87f3166d1a",
          "old_similarity_id": "3295e435cbe209c4b52fc5a3e4b68623b4335186cfe1a8644fefaa2325a27b21",
          "line": 6,
          "resource_type": "Policy",
          "resource_name": "n/a",
          "issue_type": "MissingAttribute",
          "search_key": "kind={{Policy}}.rules",
          "search_line": 6,
          "search_value": "pods/exec",
          "expected_value": "Resource 'pods/exec' should be defined in one of following levels '[\"Metadata\", \"Request\", \"RequestResponse\"]'",
          "actual_value": "Resource 'pods/exec' is currently defined with the following levels '[]'"
        },
        {
          "file_name": "path\\fixtures\\new_similarity_id\\audit_policy_not_cover_key_security_concerns.yaml",
          "similarity_id": "a6dcb94b3b1825e40f02e3796bea94599972ebd45c784fda770986331688f975",
          "old_similarity_id": "3295e435cbe209c4b52fc5a3e4b68623b4335186cfe1a8644fefaa2325a27b21",
          "line": 6,
          "resource_type": "Policy",
          "resource_name": "n/a",
          "issue_type": "MissingAttribute",
          "search_key": "kind={{Policy}}.rules",
          "search_line": 6,
          "search_value": "pods/portforward",
          "expected_value": "Resource 'pods/portforward' should be defined in one of following levels '[\"Metadata\", \"Request\", \"RequestResponse\"]'",
          "actual_value": "Resource 'pods/portforward' is currently defined with the following levels '[]'"
        },
        {
          "file_name": "path\\fixtures\\new_similarity_id\\audit_policy_not_cover_key_security_concerns.yaml",
          "similarity_id": "d10f7454a05b3efc0417bc0576bfdb6c6a95c411199eb832a82848ef243ef980",
          "old_similarity_id": "3295e435cbe209c4b52fc5a3e4b68623b4335186cfe1a8644fefaa2325a27b21",
          "line": 6,
          "resource_type": "Policy",
          "resource_name": "n/a",
          "issue_type": "MissingAttribute",
          "search_key": "kind={{Policy}}.rules",
          "search_line": 6,
          "search_value": "pods/proxy",
          "expected_value": "Resource 'pods/proxy' should be defined in one of following levels '[\"Metadata\", \"Request\", \"RequestResponse\"]'",
          "actual_value": "Resource 'pods/proxy' is currently defined with the following levels '[]'"
        },
        {
          "file_name": "path\\fixtures\\new_similarity_id\\audit_policy_not_cover_key_security_concerns.yaml",
          "similarity_id": "9d44a81ca1345d31503ca4e230ab7e9c0dc4146157b93262c847de2dece14d1e",
          "old_similarity_id": "3295e435cbe209c4b52fc5a3e4b68623b4335186cfe1a8644fefaa2325a27b21",
          "line": 6,
          "resource_type": "Policy",
          "resource_name": "n/a",
          "issue_type": "MissingAttribute",
          "search_key": "kind={{Policy}}.rules",
          "search_line": 6,
          "search_value": "secrets",
          "expected_value": "Resource 'secrets' should be defined in one of following levels '[\"Metadata\"]'",
          "actual_value": "Resource 'secrets' is currently defined with the following levels '[]'"
        },
        {
          "file_name": "path\\fixtures\\new_similarity_id\\audit_policy_not_cover_key_security_concerns.yaml",
          "similarity_id": "ba5ee61f9e0d70ff3db10d830c91acf149743d76ec1d65ac0d57a7acfa00c468",
          "old_similarity_id": "3295e435cbe209c4b52fc5a3e4b68623b4335186cfe1a8644fefaa2325a27b21",
          "line": 6,
          "resource_type": "Policy",
          "resource_name": "n/a",
          "issue_type": "MissingAttribute",
          "search_key": "kind={{Policy}}.rules",
          "search_line": 6,
          "search_value": "tokenreviews",
          "expected_value": "Resource 'tokenreviews' should be defined in one of following levels '[\"Metadata\"]'",
          "actual_value": "Resource 'tokenreviews' is currently defined with the following levels '[]'"
        },
        {
          "file_name": "path\\fixtures\\new_similarity_id\\audit_policy_not_cover_key_security_concerns.yaml",
          "similarity_id": "f648c38b5b336a59ead09ed2629c0486570a7589f61ac40fa601b5d33afbffb9",
          "old_similarity_id": "3295e435cbe209c4b52fc5a3e4b68623b4335186cfe1a8644fefaa2325a27b21",
          "line": 6,
          "resource_type": "Policy",
          "resource_name": "n/a",
          "issue_type": "MissingAttribute",
          "search_key": "kind={{Policy}}.rules",
          "search_line": 6,
          "search_value": "pods",
          "expected_value": "Resource 'pods' should be defined in one of following levels '[\"Metadata\"]'",
          "actual_value": "Resource 'pods' is currently defined with the following levels '[]'"
        },
        {
          "file_name": "path\\fixtures\\new_similarity_id\\audit_policy_not_cover_key_security_concerns.yaml",
          "similarity_id": "32263233cb4fc6b10fbb0adb3a30a7394cdd4ece92cab8b67fcff4cd7ed3e34e",
          "old_similarity_id": "3295e435cbe209c4b52fc5a3e4b68623b4335186cfe1a8644fefaa2325a27b21",
          "line": 6,
          "resource_type": "Policy",
          "resource_name": "n/a",
          "issue_type": "MissingAttribute",
          "search_key": "kind={{Policy}}.rules",
          "search_line": 6,
          "search_value": "services/proxy",
          "expected_value": "Resource 'services/proxy' should be defined in one of following levels '[\"Metadata\", \"Request\", \"RequestResponse\"]'",
          "actual_value": "Resource 'services/proxy' is currently defined with the following levels '[]'"
        },
        {
          "file_name": "path\\fixtures\\new_similarity_id\\audit_policy_not_cover_key_security_concerns.yaml",
          "similarity_id": "ee4afea4b0978fc3e3c97b2a4c96a2ed7a5bdba06074c9037f5295fedaa3ea63",
          "old_similarity_id": "3295e435cbe209c4b52fc5a3e4b68623b4335186cfe1a8644fefaa2325a27b21",
          "line": 6,
          "resource_type": "Policy",
          "resource_name": "n/a",
          "issue_type": "MissingAttribute",
          "search_key": "kind={{Policy}}.rules",
          "search_line": 6,
          "search_value": "configmaps",
          "expected_value": "Resource 'configmaps' should be defined in one of following levels '[\"Metadata\"]'",
          "actual_value": "Resource 'configmaps' is currently defined with the following levels '[]'"
        },
        {
          "file_name": "path\\fixtures\\new_similarity_id\\audit_policy_not_cover_key_security_concerns.yaml",
          "similarity_id": "844a0cf13ee70affb95563cc930c8706659240be2a190649366244d1dea22872",
          "old_similarity_id": "3295e435cbe209c4b52fc5a3e4b68623b4335186cfe1a8644fefaa2325a27b21",
          "line": 6,
          "resource_type": "Policy",
          "resource_name": "n/a",
          "issue_type": "MissingAttribute",
          "search_key": "kind={{Policy}}.rules",
          "search_line": 6,
          "search_value": "deployments",
          "expected_value": "Resource 'deployments' should be defined in one of following levels '[\"Metadata\"]'",
          "actual_value": "Resource 'deployments' is currently defined with the following levels '[]'"
        }
      ]
    }
  ]
}
