{
  "kics_version": "development",
  "files_scanned": 2,
  "lines_scanned": 54,
  "files_parsed": 2,
  "lines_parsed": 53,
  "lines_ignored": 1,
  "files_failed_to_scan": 0,
  "queries_total": 2,
  "queries_failed_to_execute": 0,
  "queries_failed_to_compute_similarity_id": 0,
  "scan_id": "console",
  "severity_counters": {
    "CRITICAL": 0,
    "HIGH": 0,
    "INFO": 0,
    "LOW": 9,
    "MEDIUM": 3,
    "TRACE": 0
  },
  "total_counter": 12,
  "total_bom_resources": 0,
  "start": "2025-08-07T12:26:42.629939596+01:00",
  "end": "2025-08-07T12:26:44.051831833+01:00",
  "paths": [
    "/path/test/fixtures/new_similarity_id"
  ],
  "queries": [
    {
      "query_name": "Container Running As Root",
      "query_id": "cf34805e-3872-4c08-bf92-6ff7bb0cfadb",
      "query_url": "https://kubernetes.io/docs/tasks/configure-pod-container/security-context/",
      "severity": "MEDIUM",
      "platform": "Kubernetes",
      "cwe": "1188",
      "cloud_provider": "COMMON",
      "category": "Best Practices",
      "experimental": false,
      "description": "Containers should only run as non-root user. This limits the exploitability of security misconfigurations and restricts an attacker's possibilities in case of compromise",
      "description_id": "9d5b1d16",
      "files": [
        {
          "file_name": "path\\test\\fixtures\\new_similarity_id\\containers_running_as_root.yaml",
          "similarity_id": "8d4cea6d1eceba2fe94a5d11bb40040a4292c7b65f492abaf91977db063978e6",
          "line": 41,
          "resource_type": "Pod",
          "resource_name": "security-context-demo-4",
          "issue_type": "IncorrectValue",
          "search_key": "metadata.name={{security-context-demo-4}}.spec.containers.name={{sec-ctx-demo-2}}.securityContext.runAsUser",
          "search_line": 41,
          "search_value": "Pod",
          "expected_value": "metadata.name={{security-context-demo-4}}.spec.containers.name={{sec-ctx-demo-2}}.securityContext runAsUser is higher than 0 and/or 'runAsNonRoot' is true",
          "actual_value": "metadata.name={{security-context-demo-4}}.spec.containers.name={{sec-ctx-demo-2}}.securityContext runAsUser is 0 and 'runAsNonRoot' is false"
        },
        {
          "file_name": "path\\test\\fixtures\\new_similarity_id\\containers_running_as_root.yaml",
          "similarity_id": "4a96a9a507cdde69e45159c01933c0576fb8b185395dcdb41128c89f98deba99",
          "line": 26,
          "resource_type": "Pod",
          "resource_name": "security-context-demo-3",
          "issue_type": "IncorrectValue",
          "search_key": "metadata.name={{security-context-demo-3}}.spec.containers.name={{sec-ctx-demo-2}}.securityContext.runAsUser",
          "search_line": 26,
          "search_value": "Pod",
          "expected_value": "metadata.name={{security-context-demo-3}}.spec.containers.name={{sec-ctx-demo-2}}.securityContext runAsUser is higher than 0 and/or 'runAsNonRoot' is true",
          "actual_value": "metadata.name={{security-context-demo-3}}.spec.containers.name={{sec-ctx-demo-2}}.securityContext runAsUser is 0 and 'runAsNonRoot' is false"
        },
        {
          "file_name": "path\\test\\fixtures\\new_similarity_id\\containers_running_as_root.yaml",
          "similarity_id": "5debd92288ab26008b0a929ef4c6259260179f870b89a70d462430e3b24d87d0",
          "line": 10,
          "resource_type": "Pod",
          "resource_name": "security-context-demo-2",
          "issue_type": "IncorrectValue",
          "search_key": "metadata.name={{security-context-demo-2}}.spec.containers.name={{sec-ctx-demo-2}}.securityContext.runAsUser",
          "search_line": 10,
          "search_value": "Pod",
          "expected_value": "metadata.name={{security-context-demo-2}}.spec.containers.name={{sec-ctx-demo-2}}.securityContext runAsUser is higher than 0 and/or 'runAsNonRoot' is true",
          "actual_value": "metadata.name={{security-context-demo-2}}.spec.containers.name={{sec-ctx-demo-2}}.securityContext runAsUser is 0 and 'runAsNonRoot' is false"
        }
      ]
    },
    {
      "query_name": "Audit Policy Not Cover Key Security Concerns",
      "query_id": "1828a670-5957-4bc5-9974-47da228f75e2",
      "query_url": "https://kubernetes.io/docs/tasks/debug-application-cluster/audit/",
      "severity": "LOW",
      "platform": "Kubernetes",
      "cwe": "532",
      "cloud_provider": "COMMON",
      "category": "Observability",
      "experimental": false,
      "description": "Audit Policy should cover key security concerns about the sensitive data logged in Kubernetes audit policies",
      "description_id": "4a720a0c",
      "files": [
        {
          "file_name": "path\\test\\fixtures\\new_similarity_id\\audit_policy_not_cover_key_security_concerns.yaml",
          "similarity_id": "0b463d1493350b0e2a9bd5c78b7a414123758d7366a70c804c0940706247abd5",
          "line": 6,
          "resource_type": "Policy",
          "resource_name": "n/a",
          "issue_type": "MissingAttribute",
          "search_key": "kind={{Policy}}.rules",
          "search_line": 6,
          "search_value": "tokenreviews",
          "expected_value": "Resource 'tokenreviews' should be defined in one of following levels '[\"Metadata\"]'",
          "actual_value": "Resource 'tokenreviews' is currently defined with the following levels '[]'"
        },
        {
          "file_name": "path\\test\\fixtures\\new_similarity_id\\audit_policy_not_cover_key_security_concerns.yaml",
          "similarity_id": "0b463d1493350b0e2a9bd5c78b7a414123758d7366a70c804c0940706247abd5",
          "line": 6,
          "resource_type": "Policy",
          "resource_name": "n/a",
          "issue_type": "MissingAttribute",
          "search_key": "kind={{Policy}}.rules",
          "search_line": 6,
          "search_value": "configmaps",
          "expected_value": "Resource 'configmaps' should be defined in one of following levels '[\"Metadata\"]'",
          "actual_value": "Resource 'configmaps' is currently defined with the following levels '[]'"
        },
        {
          "file_name": "path\\test\\fixtures\\new_similarity_id\\audit_policy_not_cover_key_security_concerns.yaml",
          "similarity_id": "0b463d1493350b0e2a9bd5c78b7a414123758d7366a70c804c0940706247abd5",
          "line": 6,
          "resource_type": "Policy",
          "resource_name": "n/a",
          "issue_type": "MissingAttribute",
          "search_key": "kind={{Policy}}.rules",
          "search_line": 6,
          "search_value": "deployments",
          "expected_value": "Resource 'deployments' should be defined in one of following levels '[\"Metadata\"]'",
          "actual_value": "Resource 'deployments' is currently defined with the following levels '[]'"
        },
        {
          "file_name": "path\\test\\fixtures\\new_similarity_id\\audit_policy_not_cover_key_security_concerns.yaml",
          "similarity_id": "0b463d1493350b0e2a9bd5c78b7a414123758d7366a70c804c0940706247abd5",
          "line": 6,
          "resource_type": "Policy",
          "resource_name": "n/a",
          "issue_type": "MissingAttribute",
          "search_key": "kind={{Policy}}.rules",
          "search_line": 6,
          "search_value": "pods",
          "expected_value": "Resource 'pods' should be defined in one of following levels '[\"Metadata\"]'",
          "actual_value": "Resource 'pods' is currently defined with the following levels '[]'"
        },
        {
          "file_name": "path\\test\\fixtures\\new_similarity_id\\audit_policy_not_cover_key_security_concerns.yaml",
          "similarity_id": "0b463d1493350b0e2a9bd5c78b7a414123758d7366a70c804c0940706247abd5",
          "line": 6,
          "resource_type": "Policy",
          "resource_name": "n/a",
          "issue_type": "MissingAttribute",
          "search_key": "kind={{Policy}}.rules",
          "search_line": 6,
          "search_value": "pods/exec",
          "expected_value": "Resource 'pods/exec' should be defined in one of following levels '[\"Metadata\", \"Request\", \"RequestResponse\"]'",
          "actual_value": "Resource 'pods/exec' is currently defined with the following levels '[]'"
        },
        {
          "file_name": "path\\test\\fixtures\\new_similarity_id\\audit_policy_not_cover_key_security_concerns.yaml",
          "similarity_id": "0b463d1493350b0e2a9bd5c78b7a414123758d7366a70c804c0940706247abd5",
          "line": 6,
          "resource_type": "Policy",
          "resource_name": "n/a",
          "issue_type": "MissingAttribute",
          "search_key": "kind={{Policy}}.rules",
          "search_line": 6,
          "search_value": "pods/portforward",
          "expected_value": "Resource 'pods/portforward' should be defined in one of following levels '[\"Metadata\", \"Request\", \"RequestResponse\"]'",
          "actual_value": "Resource 'pods/portforward' is currently defined with the following levels '[]'"
        },
        {
          "file_name": "path\\test\\fixtures\\new_similarity_id\\audit_policy_not_cover_key_security_concerns.yaml",
          "similarity_id": "0b463d1493350b0e2a9bd5c78b7a414123758d7366a70c804c0940706247abd5",
          "line": 6,
          "resource_type": "Policy",
          "resource_name": "n/a",
          "issue_type": "MissingAttribute",
          "search_key": "kind={{Policy}}.rules",
          "search_line": 6,
          "search_value": "secrets",
          "expected_value": "Resource 'secrets' should be defined in one of following levels '[\"Metadata\"]'",
          "actual_value": "Resource 'secrets' is currently defined with the following levels '[]'"
        },
        {
          "file_name": "path\\test\\fixtures\\new_similarity_id\\audit_policy_not_cover_key_security_concerns.yaml",
          "similarity_id": "0b463d1493350b0e2a9bd5c78b7a414123758d7366a70c804c0940706247abd5",
          "line": 6,
          "resource_type": "Policy",
          "resource_name": "n/a",
          "issue_type": "MissingAttribute",
          "search_key": "kind={{Policy}}.rules",
          "search_line": 6,
          "search_value": "services/proxy",
          "expected_value": "Resource 'services/proxy' should be defined in one of following levels '[\"Metadata\", \"Request\", \"RequestResponse\"]'",
          "actual_value": "Resource 'services/proxy' is currently defined with the following levels '[]'"
        },
        {
          "file_name": "path\\test\\fixtures\\new_similarity_id\\audit_policy_not_cover_key_security_concerns.yaml",
          "similarity_id": "0b463d1493350b0e2a9bd5c78b7a414123758d7366a70c804c0940706247abd5",
          "line": 6,
          "resource_type": "Policy",
          "resource_name": "n/a",
          "issue_type": "MissingAttribute",
          "search_key": "kind={{Policy}}.rules",
          "search_line": 6,
          "search_value": "pods/proxy",
          "expected_value": "Resource 'pods/proxy' should be defined in one of following levels '[\"Metadata\", \"Request\", \"RequestResponse\"]'",
          "actual_value": "Resource 'pods/proxy' is currently defined with the following levels '[]'"
        }
      ]
    }
  ]
}
