---
title: Postgres RDS logging disabled
hide:
  toc: true
  navigation: true
---

<style>
  .highlight .hll {
    background-color: #ff171742;
  }
  .md-content {
    max-width: 1100px;
    margin: 0 auto;
  }
</style>

-   **Query id:** 820882c4-0c07-4686-b1ca-c69241c57470
-   **Query name:** Postgres RDS logging disabled
-   **Platform:** Terraform
-   **Severity:** <span style="color:#edd57e">Low</span>
-   **Category:** Observability
-   **CWE:** <a href="https://cwe.mitre.org/data/definitions/778.html" onclick="newWindowOpenerSafe(event, 'https://cwe.mitre.org/data/definitions/778.html')">778</a>
-   **URL:** [Github](https://github.com/Checkmarx/kics/tree/master/assets/queries/terraform/aws/postgres_rds_logging_disabled)

### Description
Logging of executed database queries should be enabled to help assess performance impact and detect potential malicious activity.Note that these logs might contain password information and other credentials if provided in cleartext. More Information: https://repost.aws/knowledge-center/rds-postgresql-cleartext-logging<br>
[Documentation](https://registry.terraform.io/providers/hashicorp/aws/latest/docs/resources/db_parameter_group?q=log_statement#argument-reference)

### Code samples
#### Code samples with security vulnerabilities
```tf title="Positive test num. 1 - tf file" hl_lines="1"
resource "aws_db_parameter_group" "postgres_logging" {
  name   = "postgres-logging"
  family = "postgres14"
  parameter {
    name  = "log_statement"
    value = "not_all"
  }
  parameter {
    name  = "log_min_duration_statement"
    value = "not_1"
  }
}
```
```tf title="Positive test num. 2 - tf file" hl_lines="6"
resource "aws_db_parameter_group" "postgres_logging" {
  name   = "postgres-logging"
  family = "postgres14"
  parameter {
    name  = "log_statement"
    value = "not_all"
  }

  parameter {
    name  = "log_min_duration_statement"
    value = "1"
  }
}
```
```tf title="Positive test num. 3 - tf file" hl_lines="10"
resource "aws_db_parameter_group" "postgres_logging" {
  name   = "postgres-logging"
  family = "postgres14"
  parameter {
    name  = "log_statement"
    value = "all"
  }
  parameter {
    name  = "log_min_duration_statement"
    value = "not_1"
  }
}
```
<details><summary>Positive test num. 4 - tf file</summary>

```tf hl_lines="1"
resource "aws_db_parameter_group" "postgres_logging" {
  name   = "postgres-logging"
  family = "postgres14"
}

```
</details>
<details><summary>Positive test num. 5 - tf file</summary>

```tf hl_lines="1"
resource "aws_db_parameter_group" "example" {
  name   = "postgres-logging"
  family = "postgres14"
  
  parameter {
    name = "log_statement"
    value = "all"
  }
}
```
</details>
<details><summary>Positive test num. 6 - tf file</summary>

```tf hl_lines="1"
resource "aws_db_parameter_group" "example" {
  name   = "postgres-logging"
  family = "postgres14"

  parameter {
    name = "log_min_duration_statement"
    value = "1"
  }
}
```
</details>


#### Code samples without security vulnerabilities
```tf title="Negative test num. 1 - tf file"
resource "aws_db_parameter_group" "postgres_logging" {
  name   = "postgres-logging"
  family = "postgres14"
  parameter {
    name  = "log_statement"
    value = "all"
  }
  parameter {
    name  = "log_min_duration_statement"
    value = "1"
  }
}
```
