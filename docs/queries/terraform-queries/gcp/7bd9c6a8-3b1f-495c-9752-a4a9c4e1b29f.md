---
title: Beta - Ensure Essential Contacts Is Configured For Organization
hide:
  toc: true
  navigation: true
---

<style>
  .highlight .hll {
    background-color: #ff171742;
  }
  .md-content {
    max-width: 1100px;
    margin: 0 auto;
  }
</style>

-   **Query id:** 7bd9c6a8-3b1f-495c-9752-a4a9c4e1b29f
-   **Query name:** Beta - Ensure Essential Contacts Is Configured For Organization
-   **Platform:** Terraform
-   **Severity:** <span style="color:#edd57e">Low</span>
-   **Category:** Access Control
-   **CWE:** <a href="https://cwe.mitre.org/data/definitions/862.html" onclick="newWindowOpenerSafe(event, 'https://cwe.mitre.org/data/definitions/862.html')">862</a>
-   **Risk score:** <span style="color:#edd57e">1.0</span>
-   **URL:** [Github](https://github.com/Checkmarx/kics/tree/master/assets/queries/terraform/gcp/ensure_essential_contacts_is_configured_for_organization)

### Description
It is advisable to set up Essential Contacts to specify email addresses that Google Cloud can use to send important technical or security notifications.<br>
[Documentation](https://registry.terraform.io/providers/hashicorp/google/latest/docs/resources/essential_contacts_contact)

### Code samples
#### Code samples with security vulnerabilities
```tf title="Positive test num. 1 - tf file" hl_lines="10"
data "google_organization" "org" {
  organization = "123456789012"
}

resource "google_essential_contacts_contact" "positive1" {
  parent = data.google_organization.org.name
  email  = "foo@bar.com"
  language_tag = "en-GB"

  notification_category_subscriptions = [
    "LEGAL",
    "SECURITY",
    "SUSPENSION",
  ]
}

```
```tf title="Positive test num. 2 - tf file" hl_lines="10"
data "google_organization" "org" {
  organization = "123456789012"
}

resource "google_essential_contacts_contact" "positive2" {
  parent = data.google_organization.org.name
  email  = "foo@bar.com"
  language_tag = "en-GB"

  notification_category_subscriptions = [
    "BILLING", 
    "PRODUCT_UPDATES",
  ]
}

```
```tf title="Positive test num. 3 - tf file" hl_lines="6"
resource "google_essential_contacts_contact" "positive3" {
  parent = "organizations/123456789012"
  email  = "foo@bar.com"
  language_tag = "en-GB"

  notification_category_subscriptions = [
    "LEGAL",
    "SECURITY",
    "SUSPENSION",
  ]
}

```
<details><summary>Positive test num. 4 - tf file</summary>

```tf hl_lines="6"
resource "google_essential_contacts_contact" "positive4" {
  parent = "organizations/123456789012"
  email  = "foo@bar.com"
  language_tag = "en-GB"

  notification_category_subscriptions = [
    "BILLING", 
    "PRODUCT_UPDATES",
  ]
}

```
</details>


#### Code samples without security vulnerabilities
```tf title="Negative test num. 1 - tf file"
data "google_organization" "org" {
  organization = "123456789012"
}

resource "google_essential_contacts_contact" "negative1" {
  parent = data.google_organization.org.name
  email  = "foo@bar.com"
  language_tag = "en-GB"

  notification_category_subscriptions = [
    "LEGAL",
    "SECURITY",
    "SUSPENSION",
    "TECHNICAL"
  ]
}

```
```tf title="Negative test num. 2 - tf file"
data "google_organization" "org" {
  organization = "123456789012"
}

resource "google_essential_contacts_contact" "negative2" {
  parent = data.google_organization.org.name
  email  = "foo@bar.com"
  language_tag = "en-GB"

  notification_category_subscriptions = ["ALL"]
}

```
```tf title="Negative test num. 3 - tf file"
resource "google_essential_contacts_contact" "negative3" {
  parent = "organizations/123456789012"
  email = "foo@bar.com"
  language_tag = "en-GB"
  notification_category_subscriptions = [
    "LEGAL",
    "SECURITY",
    "SUSPENSION",
    "TECHNICAL"
  ]
}
```
<details><summary>Negative test num. 4 - tf file</summary>

```tf
resource "google_essential_contacts_contact" "negative4" {
  parent = "organizations/123456789012"
  email = "foo@bar.com"
  language_tag = "en-GB"
  notification_category_subscriptions = ["ALL"]
}
```
</details>
<details><summary>Negative test num. 5 - tf file</summary>

```tf
resource "google_essential_contacts_contact" "negative5" {
  parent = "folders/987654321"       # Not organization-level
  email  = "foo@bar.com"
  language_tag = "en-GB"

  notification_category_subscriptions = ["ALL"]
}
```
</details>
<details><summary>Negative test num. 6 - tf file</summary>

```tf
resource "google_essential_contacts_contact" "negative6" {
  parent = "organizations/123456789012"
  email = "foo@bar.com"
  language_tag = "en-GB"
  notification_category_subscriptions = [
    "LEGAL",
    "SECURITY",
    "SUSPENSION",
    "BILLING",
    "TECHNICAL"
  ]
}
```
</details>
<details><summary>Negative test num. 7 - tf file</summary>

```tf
data "google_organization" "org" {
  organization = "123456789012"
}

resource "google_essential_contacts_contact" "negative7" {
  parent = data.google_organization.org.name
  email  = "foo@bar.com"
  language_tag = "en-GB"

  notification_category_subscriptions = [
    "LEGAL",
    "SECURITY",
    "SUSPENSION",
    "ALL"
  ]
}

```
</details>

