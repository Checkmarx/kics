---
title: Beta - Ensure GKE Version Management Is Automated Using Release Channels
hide:
  toc: true
  navigation: true
---

<style>
  .highlight .hll {
    background-color: #ff171742;
  }
  .md-content {
    max-width: 1100px;
    margin: 0 auto;
  }
</style>

-   **Query id:** c1701dcf-24df-4675-b863-340233c4e34f
-   **Query name:** Beta - Ensure GKE Version Management Is Automated Using Release Channels
-   **Platform:** Terraform
-   **Severity:** <span style="color:#edd57e">Low</span>
-   **Category:** Best Practices
-   **CWE:** <a href="https://cwe.mitre.org/data/definitions/1188.html" onclick="newWindowOpenerSafe(event, 'https://cwe.mitre.org/data/definitions/1188.html')">1188</a>
-   **Risk score:** <span style="color:#edd57e">1.0</span>
-   **URL:** [Github](https://github.com/Checkmarx/kics/tree/master/assets/queries/terraform/gcp/ensure_gke_version_management_is_automated_using_release_channels)

### Description
Release Channel should be subscribed to Regular or Stable to automate version upgrades to the GKE cluster and to reduce version management complexity to the number of features and level of stability required.<br>
[Documentation](https://registry.terraform.io/providers/hashicorp/google/latest/docs/resources/container_cluster)

### Code samples
#### Code samples with security vulnerabilities
```tf title="Positive test num. 1 - tf file" hl_lines="1"
resource "google_container_cluster" "positive1" {
  name     = "my-gke-cluster"
  location = "us-central1"
  initial_node_count       = 1
}
```
```tf title="Positive test num. 2 - tf file" hl_lines="6"
resource "google_container_cluster" "positive2" {
  name     = "my-gke-cluster"
  location = "us-central1"
  initial_node_count       = 1
  release_channel {
    channel = "UNSPECIFIED"
  }
}
```
```tf title="Positive test num. 3 - tf file" hl_lines="6"
resource "google_container_cluster" "positive3" {
  name     = "my-gke-cluster"
  location = "us-central1"
  initial_node_count       = 1
  release_channel {
    channel = "RAPID"
  }
}
```
<details><summary>Positive test num. 4 - tf file</summary>

```tf hl_lines="6"
resource "google_container_cluster" "positive4" {
  name     = "my-gke-cluster"
  location = "us-central1"
  initial_node_count       = 1
  release_channel {
    channel = "EXTENDED"
  }
}
```
</details>


#### Code samples without security vulnerabilities
```tf title="Negative test num. 1 - tf file"
resource "google_container_cluster" "negative1" {
  name     = "my-gke-cluster"
  location = "us-central1"
  initial_node_count       = 1
  release_channel {
    channel = "REGULAR"
  }
}
```
```tf title="Negative test num. 2 - tf file"
resource "google_container_cluster" "negative2" {
  name     = "my-gke-cluster"
  location = "us-central1"
  initial_node_count       = 1
  release_channel {
    channel = "STABLE"
  }
}
```

